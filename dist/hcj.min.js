var apply=function(t){return function(n){return n(t)}};var constant=function(t){return function(n){return t}};var curry=function(t){throw"the venerable curry, we shall define at a later date"};var id=function(t){return t};var add=function(t,n){return t+n};var subtract=function(t,n){return t-n};var mathMax=function(t,n){return Math.max(t,n)};var mathMin=function(t,n){return Math.min(t,n)};var px=function(t){return t+"px"};var pushStreams=[];var pushValues=[];var pushing=false;var pushFlush=function(){var t=pushStreams;var n=pushValues;pushStreams=[];pushValues=[];pushing=false;for(var r=0;r<t.length;r++){var e=t[r];var i=n[r]}};var pushNow=function(t,n){pushStreams.push(t);pushValues.push(n);if(pushing===false){pushing=true;setTimeout(function(){setTimeout(pushFlush)})}};var stream={create:function(){return{listeners:[],lastValue:undefined}},isStream:function(t){return t&&t.hasOwnProperty("listeners")&&t.hasOwnProperty("lastValue")},once:function(t){var n=stream.create();stream.push(n,t);return n},push:function(t,n){if(t.lastValue!==n){t.lastValue=n;for(var r=0;r<t.listeners.length;r++){if(t.listeners[r]){t.listeners[r](n)}}}},map:function(t,n){var r=stream.create();if(t.lastValue!==undefined){stream.push(r,n(t.lastValue))}t.listeners.push(function(t){stream.push(r,n(t))});return r},reduce:function(t,n,r){var e=stream.once(r);if(t.lastValue!==undefined){stream.push(e,n(e.lastValue,t.lastValue))}t.listeners.push(function(t){stream.push(e,n(e.lastValue,t))});return e},filter:function(t,n){var r=stream.create();t.listeners.push(function(t){if(n(t)){stream.push(r,t)}});return stream},onValue:function(t,n){stream.map(t,function(t){n(t);return true});var r=t.listeners.length-1;return function(){delete t.listeners[r]}},promise:function(t){var n=$.Deferred();stream.map(t,function(t){n.resolve(t)});return n.promise},prop:function(t,n){return stream.map(t,function(t){return t[n]})},delay:function(t,n){var r=stream.create();stream.map(t,function(t){setTimeout(function(){stream.push(r,t)},n)});return r},pushAll:function(t,n){if(t.lastValue!==undefined){stream.push(n,t.lastValue)}return stream.onValue(t,function(t){stream.push(n,t)})},combine:function(t,n){var r=[];var e=stream.create();var i=false;var a=function(){if(!i){i=true;setTimeout(function(){i=false;for(var a=0;a<t.length;a++){if(r[a]===undefined){return}}stream.push(e,n.apply(null,r))})}};t.reduce(function(t,n){if(n.lastValue!==undefined){r[t]=n.lastValue;a()}stream.onValue(n,function(n){r[t]=n;a()});return t+1},0);return e},combineInto:function(t,n,r){var e=[];var i=false;var a=function(){if(!i){i=true;setTimeout(function(){i=false;for(var a=0;a<t.length;a++){if(e[a]===undefined){return}}stream.push(r,n.apply(null,e))})}};t.reduce(function(t,n){if(n.lastValue!==undefined){e[t]=n.lastValue;a()}stream.onValue(n,function(n){e[t]=n;a()});return t+1},0)},all:function(t,n){return stream.combine(t,function(){n.apply(null,arguments);return true})},combineObject:function(t){var n=Object.keys(t);var r={};var e=stream.create();var i=false;var a=function(){if(!i){i=true;setTimeout(function(){i=false;for(var t=0;t<n.length;t++){var a=n[t];if(r[a]===undefined){return}}stream.push(e,$.extend({},r))})}};n.map(function(n,e){stream.onValue(t[n],function(t){r[n]=t;a()})});return e},splitObject:function(t){var n=Object.keys(t);var r={};n.map(function(n){r[n]=stream.once(t[n])});return r},fromEvent:function(t,n){var r=stream.create();t.on("event",function(t){stream.push(r,t)});return r},fromPromise:function(t,n){var r=stream.create();if(n){stream.push(r,n)}t.then(function(t){stream.push(r,t)});return r},cases:function(t,n){t.push(n);return stream.combine(t,function(){var t=Array.prototype.slice.call(arguments);var n=t.pop();return t[n]})}};var onceZeroS=stream.once(0);var updateDomEls=[];var updateDomProps=[];var updateDomValues=[];var runDomFuncs=function(){for(var t=0;t<updateDomEls.length;t++){updateDomEls[t].css(updateDomProps[t],updateDomValues[t])}updateDomEls=[];updateDomProps=[];updateDomValues=[]};var updateDomFunc=function(t,n,r){if(updateDomEls.length===0){setTimeout(runDomFuncs)}updateDomEls.push(t);updateDomProps.push(n);updateDomValues.push(r)};var measureWidth=function(t,n){var r=$(".sandbox");var e=t.clone();e.css("width",n?px(n):"").css("height","").css("display","inline-block").appendTo(r);var i=e[0].scrollWidth;e.remove();return i};var measureHeight=function(t){return function(n){var r=$(".sandbox");var e=t.clone();e.css("width",px(n)).css("height","").appendTo(r);var i=parseInt(e.css("height"));e.remove();return i}};var el=function(t,n,r){var e=$(document.createElement(t));if(t==="textarea"){}var i=[];r.child=function(t){t=t||{};["width","height","top","left"].map(function(n){if(t[n]===true){t[n]=stream.create()}});return{$el:e,width:t.width||r.width,height:t.height||r.height,top:t.top||onceZeroS,left:t.left||onceZeroS,topAccum:stream.combine([r.topAccum,r.top],add),leftAccum:stream.combine([r.leftAccum,r.left],add),unbuild:i.push}};var a={$el:e};var u=n(e,r,function(t){var n=measureWidth(e,t);if(a.minWidth){stream.push(a.minWidth,n)}else{a.initialMinWidth=n}},function(){var t=measureHeight(e);if(a.minHeight){stream.push(a.minHeight,t)}else{a.initialMinHeight=t}})||{};a.minWidth=u.minWidth?u.minWidth:stream.create();a.minHeight=u.minHeight?u.minHeight:stream.create();if(a.initialMinWidth){stream.push(a.minWidth,a.initialMinWidth)}if(a.initialMinHeight){stream.push(a.minHeight,a.initialMinHeight)}e.appendTo(r.$el);e.before(" ");e.after(" ");a.destroy=function(){i.map(apply());e.remove()};return a};var callEl=function(t){return function(n){return function(r){return el(t,n,r)}}};var a=callEl("a");var button=callEl("button");var div=callEl("div");var form=callEl("form");var iframe=callEl("iframe");var img=callEl("img");var input=callEl("input");var li=callEl("li");var option=callEl("option");var select=callEl("select");var textarea=callEl("textarea");var ul=callEl("ul");var stream=stream;var apply=apply;var constant=constant;var curry=curry;var id=id;var add=add;var subtract=subtract;var mathMax=mathMax;var mathMin=mathMin;var measureWidth=measureWidth;var measureHeight=measureHeight;var updateDomFunc=updateDomFunc;var caseSplit=function(t,n){if(!n){return function(n){for(var r in t){if(t.hasOwnProperty(r)&&n.hasOwnProperty(r)){if(!$.isFunction(t[r])){return t[r]}return t[r](n[r])}}}}for(var r in t){if(t.hasOwnProperty(r)&&n.hasOwnProperty(r)){if(!$.isFunction(t[r])){return t[r]}return t[r](n[r])}}};var _scrollbarWidth=function(){var t,n,r;if(r===undefined){t=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body");n=t.children();r=n.innerWidth()-n.height(99).innerWidth();t.remove()}return r};var unit=function(t){return function(n){return n+t}};var px=unit("px");var vw=unit("vw");var onceZeroS=stream.once(0);var windowWidth=stream.create();var windowHeight=stream.create();var updateWindowWidth=function(){stream.push(windowWidth,window.innerWidth)};var updateWindowHeight=function(){stream.push(windowHeight,window.innerHeight)};$(updateWindowWidth);$(updateWindowHeight);$(window).on("resize",function(){updateWindowWidth();updateWindowHeight()});var windowResize=stream.once(null,true);$(window).on("resize",function(t){stream.push(windowResize,t)});var windowScroll=stream.create(true);$(window).on("scroll",function(){stream.push(windowScroll,window.scrollY)});stream.push(windowScroll,window.scrollY);var windowHash=stream.create(true);$(window).on("hashchange",function(){stream.push(windowHash,location.pathname)});stream.push(windowHash,location.pathname);var layoutRecurse=function(t,n,r){if($.isArray(r)){return r.map(function(r){return layoutRecurse(t,n,r)})}else{return function(t){var e=r(t);if(!e.minWidth||!e.minHeight){console.log("not a component")}n.unbuild(e.destroy);e.$el.css("visibility","hidden").css("position","absolute").css("pointer-events","initial");stream.onValue(t.width,function(t){updateDomFunc(e.$el,"width",t)});stream.onValue(t.height,function(t){updateDomFunc(e.$el,"height",t)});stream.onValue(t.top,function(t){updateDomFunc(e.$el,"top",t)});stream.onValue(t.left,function(t){updateDomFunc(e.$el,"left",t)});stream.combine([t.width,t.height,t.top,t.left],function(){updateDomFunc(e.$el,"visibility","initial")});return e}}};var layout=function(t,n){var r=n?t:div;var e=n||t;return function(){var t=Array.prototype.slice.call(arguments);return r(function(n,r){n.css("pointer-events","none").css("position","relative");return e.apply(null,[n,r].concat(layoutRecurse(n,r,t)))})}};var container=function(t,n){var r=n?t:div;var e=n||t;return div(function(t,n){return e(t,n,function(r){return layoutRecurse(t,n,r)})})};var all=function(t){return function(n){return t.reduce(function(t,n){return n(t)},n)}};var rootComponent=function(t){var n=_scrollbarWidth();var r=stream.create();var e=stream.create();var i=stream.create();stream.combine([windowWidth,windowHeight,i],function(t,i,a){var u=a(t);if(u>i){var o=a(t-n);if(o>i){$("body").css("overflow-y","initial");stream.push(r,t-n);stream.push(e,o)}else{$("body").css("overflow-y","scroll");stream.push(r,t-n);stream.push(e,o)}}else{$("body").css("overflow-y","initial");stream.push(r,t);stream.push(e,u)}});var a=[];var u=t({$el:$("body"),width:r,height:e,top:onceZeroS,left:onceZeroS,topAccum:onceZeroS,leftAccum:onceZeroS,unbuild:a.push});u.$el.css("position","absolute");var o=u.destroy;u.destroy=function(){a.map(apply());o()};stream.pushAll(u.minHeight,i);stream.all([r,e],function(t,n){u.$el.css("width",px(t)).css("height",px(n))});return u};var color=function(t){return $.extend({r:0,g:0,b:0,a:1},t)};var multiplyColor=function(t){return function(n){return{r:Math.min(255,n.r*t),g:Math.min(255,n.g*t),b:Math.min(255,n.b*t),a:n.a}}};var desaturate=function(t){return function(n){var r=(n.r+n.g+n.b)/3;var e=1-t;return{r:e*n.r+t*r,g:e*n.g+t*r,b:e*n.b+t*r,a:n.a}}};var colorBrightness=function(t){return(t.r+t.g+t.b)/(255+255+255)};var colorString=function(t){return"rgba("+Math.floor(t.r)+","+Math.floor(t.g)+","+Math.floor(t.b)+","+t.a+")"};var rgbColorString=function(t){return"rgb("+Math.floor(t.r)+","+Math.floor(t.g)+","+Math.floor(t.b)+")"};var transparent=color({a:0});var black=color({r:0,g:0,b:0});var white=color({r:255,g:255,b:255});var mapMinWidths=function(t){return stream.combine(t.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t})};var mapMinHeights=function(t){return stream.combine(t.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t})};var url=function(t){return'url("'+t+'")'};var and=function(t){return function(n){return function(r){var e=n(r);t(e,r);return e}}};var $$=function(t){return and(function(n){return t(n.$el)})};var jqueryMethod=function(t){return function(){var n=Array.prototype.slice.call(arguments);return $$(function(r){r[t].apply(r,n)})}};var $addClass=jqueryMethod("addClass");var $attr=jqueryMethod("attr");var $css=jqueryMethod("css");var $on=jqueryMethod("on");var $prop=jqueryMethod("prop");var useMinWidth=function(t,n){return stream.pushAll(n.minWidth,t.width)};var useMinHeight=function(t,n){return stream.combineInto([t.width,n.minHeight],function(t,n){return n(t)},t.height)};var withMinWidth=function(t){return layout(function(n,r,e){n.addClass("withMinWidth");var i=e(r.child());return{minWidth:stream.once(t),minHeight:i.minHeight}})};var withMinHeight=function(t){return layout(function(n,r,e){n.addClass("withMinHeight");var i=e(r.child());return{minWidth:i.minWidth,minHeight:stream.once(constant(t))}})};var passthrough=function(t){return layout(function(n,r,e){n.addClass("passthrough");t(n);return e(r.child())})};var link=$css("cursor","pointer");var onThis=function(t){return function(n){return $on(t,n)}};var changeThis=onThis("change");var clickThis=onThis("click");var inputPropertychangeThis=onThis("input propertychange");var keydownThis=onThis("keydown");var keyupThis=onThis("keyup");var mousedownThis=onThis("mousedown");var mousemoveThis=onThis("mousemove");var mouseoverThis=onThis("mouseover");var mouseoutThis=onThis("mouseout");var mouseupThis=onThis("mouseup");var submitThis=onThis("submit");var pushOnClick=function(t,n){return clickThis(function(r){stream.push(t,n(r))})};var keepAspectRatio=function(t){t=t||{};return layout(function(n,r,e){n.addClass("keepAspectRatio");var i=stream.create();var a=stream.create();var u=stream.combine([i,a,r.width,r.height],function(n,r,e,i){var a=n/r(n);var u=e/i;if(!t.fill&&u>a||t.fill&&u<a){var o=i*a;var s;if(t.left){s=0}else if(t.right){s=e-o}else{s=(e-o)/2}return{top:0,left:s,width:o,height:i}}else{var c=e/a;var h;if(t.top){h=0}else if(t.bottom){h=i-c}else{h=(i-c)/2}return{top:h,left:0,width:e,height:c}}});var o=e(r.child({top:stream.prop(u,"top"),left:stream.prop(u,"left"),width:stream.prop(u,"width"),height:stream.prop(u,"height")}));stream.pushAll(o.minWidth,i);stream.pushAll(o.minHeight,a);return{minWidth:o.minWidth,minHeight:stream.combine([o.minWidth,o.minHeight],function(t,n){return function(r){return r/(t/n(t))}})}})};var image=function(t){var n=stream.isStream(t.src)?t.src:stream.once(t.src);return img(function(r,e){var i=stream.create();var a=stream.create();stream.map(n,function(t){r.prop("src",t)});r.on("load",function(){var n=r[0].naturalWidth/r[0].naturalHeight;var e=t.minWidth||r[0].naturalWidth;var u=e/n;stream.push(i,e);stream.push(a,constant(u))});return{minWidth:i,minHeight:a}})};var linkTo=function(t){return layout(a,function(n,r,e){n.prop("href",t);n.css("pointer-events","initial");return e(r.child())})};var nothing=div(function(t,n){return{minWidth:onceZeroS,minHeight:stream.once(constant(0))}});var text=function(t,n){t=t||"";if(!$.isArray(t)){t=[t]}n=n||t[0];return div(function(r,e){var i=false;var a=stream.create();var u=stream.create();t.map(function(t){if($.type(t)==="string"){t={str:t}}var n=$(document.createElement("span"));n.html(t.str);if(t.size){n.css("font-size",t.size)}if(t.weight){n.css("font-weight",t.weight)}if(t.font){n.css("font-family",t.font)}if(t.color){n.css("color",colorString(t.color))}n.appendTo(r)});if(n.size){r.css("font-size",n.size)}if(n.weight){r.css("font-weight",n.weight)}if(n.font){r.css("font-family",n.font)}if(n.color){r.css("color",n.color)}if(n.align){r.css("text-align",n.align)}stream.push(a,measureWidth(r,n.minWidth));stream.push(u,measureHeight(r));return{minWidth:a,minHeight:u}})};var ignoreSurplusWidth=function(t,n){return n};var ignoreSurplusHeight=function(t,n){return n};var centerSurplusWidth=function(t,n){var r=n[n.length-1];var e=t-(r.left+r.width);var i=e/n.length;n.map(function(t,n){t.left+=e/2});return n};var evenSplitSurplusWidth=function(t,n){var r=n[n.length-1];var e=t-(r.left+r.width);var i=e/n.length;n.map(function(t,n){t.width+=i;t.left+=n*i});return n};var evenSplitSurplusWidthWithMinPerRow=function(t){return function(n,r){var e=r[r.length-1];var i=n-(e.left+e.width);var a=n/Math.max(t,r.length);r.map(function(t,n){t.width=a;t.left=n*a});e=r[r.length-1];i=n-(e.left+e.width);a=i/r.length;r.map(function(t,n){t.left+=i/2});return r}};var justifySurplusWidth=function(t,n){var r=n[n.length-1];var e=t-(r.left+r.width);n.map(function(t,r){for(var i=0;i<r;i++){t.left+=e/(n.length-1)}});return n};var justifyAndCenterSurplusWidth=function(t,n){var r=n[n.length-1];var e=t-(r.left+r.width);n.map(function(t,r){t.left+=r*e/n.length+e/(2*n.length)});return n};var surplusWidthAlign=function(t){return function(n,r){var e=r[r.length-1];var i=n-(e.left+e.width);r.map(function(n,r){n.left+=t*i});return r}};var surplusWidthAlignLeft=surplusWidthAlign(0);var surplusWidthAlignCenter=surplusWidthAlign(.5);var surplusWidthAlignRight=surplusWidthAlign(1);var superSurplusWidth=function(t,n){var r=n[n.length-1];var e=t-(r.left+r.width);if(n.length===1){if(e<n[0].width){return evenSplitSurplusWidth(t,n)}else{return n}}if(n.length===2){return justifyAndCenterSurplusWidth(t,n)}return justifySurplusWidth(t,n)};var giveToNth=function(t){return function(n,r){var e=r[r.length-1];var i=n-(e.left+e.width);r.map(function(n,e){if(e===t||e===r.length-1&&t>=r.length){n.width+=i}else if(e>t){n.left+=i}});return r}};var giveToFirst=giveToNth(0);var giveToSecond=giveToNth(1);var giveToThird=giveToNth(2);var centerSurplusHeight=function(t,n){var r=n[n.length-1];var e=t-(r.top+r.height);n.map(function(t,n){t.top+=e/2});return n};var giveHeightToNth=function(t){return function(n,r){var e=r[r.length-1];var i=n-(e.top+e.height);r.map(function(n,e){if(e===t||e===r.length-1&&t>=r.length){n.height+=i}else if(e>t){n.top+=i}});return r}};var giveHeightToLast=function(t,n){var r=n.length-1;var e=n[n.length-1];var i=t-(e.top+e.height);n.map(function(t,e){if(e===r||e===n.length-1&&r>=n.length){t.height+=i}else if(e>r){t.top+=i}});return n};var sideBySide=function(t){t=t||{};t.padding=t.padding||0;t.handleSurplusWidth=t.handleSurplusWidth||ignoreSurplusWidth;return layout(function(n,r,e){if(e.length===0){return{minWidth:stream.once(0),minHeight:stream.once(constant(0))}}var i=[];var a=e.map(function(t){var n=r.child({left:true,width:true});i.push(n);return t(n)});var u=mapMinWidths(a);var o=mapMinHeights(a);var s=[o];var c=function(n,r){var e=0;var i=r.map(function(n,r){var i={left:e+t.padding*r,width:n};e+=n;return i});i=t.handleSurplusWidth(n,i);return i};stream.all([r.width,u,o,t.sourcePositionsS||stream.once([])],function(n,r,e,a){var u=c(n,r);if(t.targetPositionsS){stream.push(t.targetPositionsS,u)}a.map(function(t,n){u[n]=t});u.map(function(t,n){var r=i[n];stream.push(r.left,t.left);stream.push(r.width,t.width)})});return{minWidth:stream.map(u,function(n){return n.reduce(add,t.padding*(a.length-1))}),minHeight:stream.combine([u,o],function(t,n){return function(r){var e=c(r,t);return e.map(function(t,r){return n[r](e[r].width)}).reduce(mathMax,0)}})}})};var stack=function(t){t=t||{};t.padding=t.padding||0;t.handleSurplusHeight=t.handleSurplusHeight||ignoreSurplusHeight;t.transition=t.transition||0;var n=t.transition+"s";return layout(function(r,e,i){r.addClass("stack");if(i.length===0){return{minWidth:stream.once(0),minHeight:stream.once(constant(0))}}var a=[];var u=i.map(function(t){var n=e.child({top:true,height:true});a.push(n);return t(n)});var o=mapMinWidths(u);var s=mapMinHeights(u);u.map(function(t){t.$el.css("transition","height "+n+", top "+n)});stream.all([e.width,e.height,s],function(n,r,e){var i=0;var u=e.map(function(r,e){var a={top:i+t.padding*e,height:r(n)};i+=r(n);return a});u=t.handleSurplusHeight(r,u);u.map(function(t,n){var r=a[n];stream.push(r.top,t.top);stream.push(r.height,t.height)})});return{minWidth:stream.map(o,function(t){return t.reduce(mathMax,0)}),minHeight:stream.map(s,function(n){return function(r){return n.map(apply(r)).reduce(add,t.padding*(u.length-1))}})}})};var stackStream=function(t){t=t||{};t.padding=t.padding||0;t.handleSurplusHeight=t.handleSurplusHeight||ignoreSurplusHeight;t.transition=t.transition||0;return function(n){return container(function(r,e,i){var a=stream.once(0);var u=stream.once(constant(0));var o=[];var s=[];var c=[];var h=[];var l=function(){var n=e.width.lastValue;var r=e.height.lastValue;var i=[];var c=[];s.map(function(t,n){i[n]=t.minWidth.lastValue;c[n]=t.minHeight.lastValue});if(!i.concat(c).reduce(function(t,n){return t&&n!==undefined},true)){return}stream.push(a,i.reduce(mathMax,0));stream.push(u,function(n){return c.map(apply(n)).reduce(add,t.padding*(s.length-1))});if(n===undefined){return}if(r===undefined){return}var h=0;var l=-1;var m=c.map(function(r){l+=1;var e={top:h+t.padding*l,height:r(n)};h+=r(n);return e});m=t.handleSurplusHeight(r,m);o.map(function(t,n){var r=m[n];stream.push(t.top,r.top);stream.push(t.height,r.height)})};stream.onValue(e.width,l);stream.onValue(e.height,l);var m=[];var f=-1;var d=function(t){f+=1;var n=e.child({top:true,height:true});var r=i(t)(n);m[f]=t;c[f]=stream.onValue(r.minWidth,l);h[f]=stream.onValue(r.minHeight,l);o[f]=n;s[f]=r;return f};var p=function(t){var n=m.indexOf(t);s[n].destroy();c[n]();h[n]();delete c[n];delete h[n];delete o[n];delete s[n];l()};stream.onValue(n,function(t){caseSplit({insert:d,insertMany:function(t){t.map(d)},remove:p},t)});return{minWidth:a,minHeight:u}})}};var margin=function(t){var n=t.all||0,r=t.all||0,e=t.all||0,i=t.all||0;if($.isNumeric(t)){n=r=e=i=t}else{for(var a in t){var u=a.toLowerCase();if(t[a]!==null){if(u.indexOf("top")!==-1){n=t[a]}if(u.indexOf("bottom")!==-1){r=t[a]}if(u.indexOf("left")!==-1){e=t[a]}if(u.indexOf("right")!==-1){i=t[a]}}}}return layout(function(t,a,u){t.addClass("margin");var o=u(a.child({top:stream.once(n),left:stream.once(e),width:stream.map(a.width,function(t){return t-e-i}),height:stream.map(a.height,function(t){return t-n-r})}));return{minWidth:stream.map(o.minWidth,function(t){return t+e+i}),minHeight:stream.map(o.minHeight,function(t){return function(e){return t(e)+n+r}})}})};var alignLRM=function(t){t=t||{};t.transition=(t.transition||0)+"s";return function(n){return layout(function(n,r,e,i,a){n.addClass("alignLRM");var u=r.child({width:true});var o=r.child({width:true,left:true});var s=r.child({width:true,left:true});var c=e(u);var h=i(o);var l=a(s);useMinWidth(u,c);useMinWidth(o,h);stream.combineInto([h.minWidth,r.width],function(t,n){return n-t},o.left);useMinWidth(s,l);stream.combineInto([l.minWidth,r.width],function(t,n){return(n-t)/2},s.left);c.$el.css("transition","left "+t.transition);h.$el.css("transition","left "+t.transition);l.$el.css("transition","left "+t.transition);return{minWidth:stream.combine([c.minWidth,h.minWidth,l.minWidth],function(t,n,r){return[t,n,r].reduce(add)}),minHeight:stream.combine([c.minWidth,h.minWidth,l.minWidth,c.minHeight,h.minHeight,l.minHeight],function(t,n,r,e,i,a){return function(u){return[e(t),i(n),a(r)].reduce(mathMax)}})}})(n.l||nothing,n.r||nothing,n.m||nothing)}};var center=function(t){return function(n){return alignLRM(t)({m:n})}};var alignTBM=function(t){t=t||{};t.transition=(t.transition||0)+"s";return function(n){return layout(function(n,r,e,i,a){n.addClass("alignTBM");var u=r.child({height:true});var o=r.child({height:true,top:true});var s=r.child({height:true,top:true});var c=e(u);var h=i(o);var l=a(s);useMinHeight(u,c);useMinHeight(o,h);stream.combineInto([h.minHeight,r.height,r.width],function(t,n,r){return n-t(r)},o.top);useMinHeight(s,l);stream.combineInto([l.minHeight,r.height,r.width],function(t,n,r){return(n-t(r))/2},s.top);c.$el.css("transition","top "+t.transition);h.$el.css("transition","top "+t.transition);l.$el.css("transition","top "+t.transition);return{minWidth:stream.combine([c.minWidth,h.minWidth,l.minWidth],function(t,n,r){return[t,n,r].reduce(mathMax)}),minHeight:stream.combine([c.minHeight,h.minHeight,l.minHeight],function(t,n,r){return function(e){return[t,n,r].map(apply(e)).reduce(add)}})}})(n.t||nothing,n.b||nothing,n.m||nothing)}};var border=function(t,n,r){var e=n.left||n.all||0;var i=n.right||n.all||0;var a=n.top||n.all||0;var u=n.bottom||n.all||0;var o=n.radius||0;r=r||"solid";if(!stream.isStream(t)){t=stream.once(t)}var s=stream.map(t,colorString);return layout(function(t,n,c){t.addClass("border");var h=c(n.child({width:stream.map(n.width,function(t){return t-e-i}),height:stream.map(n.height,function(t){return t-a-u})}));h.$el.css("border-radius",px(o));stream.map(s,function(t){h.$el.css("border-left",px(e)+" "+r+" "+t).css("border-right",px(i)+" "+r+" "+t).css("border-top",px(a)+" "+r+" "+t).css("border-bottom",px(u)+" "+r+" "+t)});return{minWidth:stream.map(h.minWidth,function(t){return t+e+i}),minHeight:stream.map(h.minHeight,function(t){return function(n){return t(n)+a+u}})}})};var componentStream=function(t){var n=new Error;return div(function(n,r,e){n.addClass("componentStream");var i;var a;var u;e(function(){if(i){i.destroy()}});var o=stream.create();var s=stream.create();var c=stream.reduce(t,function(t,n){if(t){t.destroy()}if(a){a()}if(u){u()}t=n(r.child());a=stream.pushAll(t.minWidth,o);u=stream.pushAll(t.minHeight,s);return t});return{minWidth:o,minHeight:s}})};var promiseComponent=function(t){var n=stream.create();Q(t).then(function(t){stream.push(n,t)},function(t){console.log(t)}).catch(function(t){console.log(t)});return componentStream(n)};var withMinHeightStream=function(t){return layout(function(n,r,e){n.addClass("withMinHeightStream");var i=e(r.child());return{minWidth:i.minWidth,minHeight:$.isFunction(t)?t(i):t}})};var minHeightAtLeast=function(t){if(!stream.isStream(t)){t=stream.once(t)}return withMinHeightStream(function(n){return stream.combine([n.minHeight,t],function(t,n){return function(r){return Math.max(t(r),n)}})})};var overlays=function(t){return layout(function(t,n,r){var e=r.map(function(t){return t(n.child())});var i=function(t){return stream.combine(t,function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)})};return{minWidth:stream.combine(e.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}),minHeight:stream.combine(e.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return function(n){return t.map(apply(n)).reduce(mathMax,0)}})}})};var matchStrings=function(t){return function(n){for(var r=0;r<t.length;r++){var e=t[r];if(n.indexOf(e.string)===0){return e.router(n.substring(e.string.length))}}}};var routeToComponent=function(t){return function(){return t}};var routeToComponentF=function(t){return function(){return t()}};var routeToFirst=function(t){return function(n){for(var r=0;r<t.length;r++){var e=t[r](n);if(e){return e}}}};var routeMatchRest=function(t){return function(n){return promiseComponent(Q(n).then(t))}};var route=function(t,n){return componentStream(stream.map(t,function(t){return n(t)}))};