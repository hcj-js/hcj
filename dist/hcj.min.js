var color=function(t){return $.extend({r:0,g:0,b:0,a:1},t)};var multiplyColor=function(t){return function(e){return{r:Math.min(255,e.r*t),g:Math.min(255,e.g*t),b:Math.min(255,e.b*t),a:e.a}}};var desaturate=function(t){return function(e){var n=(e.r+e.g+e.b)/3;var r=1-t;return{r:r*e.r+t*n,g:r*e.g+t*n,b:r*e.b+t*n,a:e.a}}};var colorBrightness=function(t){return(t.r+t.g+t.b)/(255+255+255)};var colorString=function(t){return"rgba("+Math.floor(t.r)+","+Math.floor(t.g)+","+Math.floor(t.b)+","+t.a+")"};var rgbColorString=function(t){return"rgb("+Math.floor(t.r)+","+Math.floor(t.g)+","+Math.floor(t.b)+")"};var transparent=color({a:0});var black=color({r:0,g:0,b:0});var white=color({r:255,g:255,b:255});var stream={create:function(){return{listeners:[],lastValue:undefined,ended:false}},isStream:function(t){return t.hasOwnProperty("listeners")&&t.hasOwnProperty("lastValue")&&t.hasOwnProperty("ended")},once:function(t){var e=stream.create();stream.push(e,t);return e},push:function(t,e){if(t.lastValue!==e&&!t.ended){t.lastValue=e;for(var n=0;n<t.listeners.length;n++){t.listeners[n](e)}}},map:function(t,e){var n=stream.create();if(t.lastValue!==undefined){stream.push(n,e(t.lastValue))}t.listeners.push(function(t){stream.push(n,e(t))});return n},reduce:function(t,e,n){var r=stream.once(n);if(t.lastValue!==undefined){stream.push(r,e(t.lastValue,n))}t.listeners.push(function(t){stream.push(r,e(t,r.lastValue))});return r},filter:function(t,e){var n=stream.create();if(t.lastValue!==undefined){e(t.lastValue,n.push)}t.listeners.push(function(t){e(t,n.push)});return stream},onValue:function(t,e){return stream.map(t,function(t){e(t);return true})},promise:function(t){var e=$.Deferred();if(t.lastValue){e.resolve(t.lastValue)}else{stream.map(t,function(t){e.resolve(t)})}return e.promise},prop:function(t,e){return stream.map(t,function(t){return t[e]})},delay:function(t,e){var n=stream.create();stream.map(t,function(t){setTimeout(function(){stream.push(n,t)},e)});return stream},end:function(t){t.ended=true},pushAll:function(t,e){stream.onValue(t,function(t){stream.push(e,t)})},never:function(){return stream.create()},combine:function(t,e){var n=[];var r=stream.create();var i=false;var a=new Error;var o=function(){if(!i){i=true;setTimeout(function(){a;i=false;for(var o=0;o<t.length;o++){if(n[o]===undefined){return}}stream.push(r,e.apply(null,n))})}};t.reduce(function(t,e){stream.onValue(e,function(e){n[t]=e;o()});return t+1},0);return r},all:function(t,e){return stream.combine(t,function(){e.apply(null,arguments);return true})},combineObject:function(t){var e=Object.keys(t);var n={};var r=stream.create();var i=false;var a=function(){if(!i){i=true;setTimeout(function(){i=false;for(var t=0;t<e.length;t++){var a=e[t];if(n[a]===undefined){return}}stream.push(r,$.extend({},n))})}};e.map(function(e,r){stream.onValue(t[e],function(t){n[e]=t;a()})});return r},splitObject:function(t){var e=Object.keys(t);var n={};e.map(function(e){n[e]=stream.once(t[e])});return n},fromPromise:function(t,e){var n=stream.never();if(e){stream.push(n,e)}t.then(function(t){stream.push(n,t)});return n},cases:function(t,e){t.push(e);return stream.combine(t,function(){var t=Array.prototype.slice.call(arguments);var e=t.pop();return t[e]})}};var child=function(t){if(!t||!t.create){console.error("faulty component")}return function(e){e.child(t)}};var children=function(t){t.map(function(t){if(!t||!t.create){console.error("faulty component")}});return function(e){e.children(t)}};var wireChildren=function(t){return function(e){e.wireChildren=t}};var component=function(t){var e={create:function(t){var e=this.build(t);e.wireChildren=e.wireChildren||function(){};var n=e.childComponentPs;var r=[];var i=n.map(function(t){if($.isArray(t)){var n=[];var i=t.map(function(t){var r=e.newCtx();n.push(r);return t.create(r)});r.push(n);return i}else{var a=e.newCtx();r.push(a);return t.create(a)}});e.childInstances=i;var a=e.wireChildren.apply(null,[e,t].concat(i))||[];var o=function(t,e,n){t=t||{};if(t.top){stream.pushAll(t.top,n.top)}if(t.left){stream.pushAll(t.left,n.left)}if(t.width){stream.pushAll(t.width,n.width)}if(t.height){stream.pushAll(t.height,n.height)}if(t.backgroundColor){stream.pushAll(t.backgroundColor,n.backgroundColor)}if(t.fontColor){stream.pushAll(t.fontColor,n.fontColor)}};for(var u=0;u<i.length;u++){var s=a[u]||{};var h=i[u];var l=r[u];if($.isArray(h)){for(var c=0;c<h.length;c++){o(s[c],h[c],l[c])}}else{o(s,h,l)}}return e},build:t,and:function(t){var e=this;var n=$.extend({},e);n.build=function(n){var r=e.build(n);var i=t(r,n);var a=r.destroy;if(i){r.destroy=function(){var t=i();if(t){t.then(function(){a.apply(r)})}else{a.apply(r)}}}return r};return n},all:function(t){return t.reduce(function(t,e){return t.and(e)},this)},compose:function(t){return t.reduce(function(t,e){return e(t)},this)}};return e};var liftC=function(t){return function(e){return e.and(t)}};var liftCF=function(t){return function(){var e=arguments;return function(n){return n.and(t.apply(null,e))}}};var findOptimalHeight=function(t,e){var n=$(".sandbox");var r=t.clone();r.css("height","").css("width",e).appendTo(n);var i=parseInt(r.css("height"));r.remove();return i};var findMinWidth=function(t){var e=$(".sandbox");var n=t.clone();n.css("width","").css("height","").appendTo(e);var r=parseInt(n.css("width"));n.remove();return r};var findScrollWidth=function(t,e){var n=$(".sandbox");var r=t.clone();r.css("width",e).css("height","").appendTo(n);var i=r[0].scrollWidth;r.remove();return i};var findMinHeight=function(t){var e=$(".sandbox");var n=t.clone();n.css("width","").css("height","").appendTo(e);var r=parseInt(n.css("height"));n.remove();return r};var updateDomFuncs=[];var applyFunc=function(t){t.$el.css(t.prop,t.value)};var runDomFuncs=function(){updateDomFuncs.map(applyFunc);updateDomFuncs=[];updateWindowWidth()};var updateDomFunc=function(t){if(updateDomFuncs.length===0){setTimeout(runDomFuncs)}updateDomFuncs.push(t)};var el=function(t){return component(function(e){var n=stream.never();var r=stream.never();var a=function(){var t=findMinHeight(i.$el);stream.push(i.minWidth,mw);stream.push(i.minHeight,t)};var o=$(document.createElement(t));if(o.prop("tagName").toLowerCase()==="div"){o.css("pointer-events","none")}else{o.css("pointer-events","initial")}o.css("position","absolute");o.css("visibility","hidden");e.$el.append(o);stream.onValue(e.top,function(t){updateDomFunc({$el:o,prop:"top",value:px(t)})});stream.onValue(e.left,function(t){updateDomFunc({$el:o,prop:"left",value:px(t)})});stream.onValue(e.width,function(t){updateDomFunc({$el:o,prop:"width",value:px(t)})});stream.onValue(e.height,function(t){updateDomFunc({$el:o,prop:"height",value:px(t)})});stream.combine([e.width,e.height,e.top,e.left],function(){updateDomFunc({$el:o,prop:"visibility",value:""})});stream.onValue(e.backgroundColor,function(t){o.css("background-color",colorString(t))});stream.onValue(e.fontColor,function(t){o.css("color",colorString(t))});var u=[];var s=stream.combine([e.scroll,e.top],function(t,e){return t-e});var h=stream.combine([e.topAccum,e.top],function(t,e){return t+e});var l=stream.combine([e.leftAccum,e.left],function(t,e){return t+e});var c=stream.combine([e.brightness,e.backgroundColor],function(t,e){var n=colorBrightness(e);return e.a*n+(1-e.a)*t});var m=function(t){return{$el:o,scroll:s,topAccum:h,top:stream.never(),left:stream.never(),leftAccum:l,width:stream.never(),height:stream.never(),backgroundColor:stream.once(transparent),fontColor:stream.never(),brightness:c}};return{$el:o,optimalWidth:0,minWidth:n,minHeight:r,newCtx:m,childComponentPs:u,child:function(t){u.push(t)},children:function(t){u.push(t)},destroy:function(){stream.end(n);stream.end(r);var t=this.childInstances||[];for(var e=0;e<t.length;e++){var i=t[e];if($.isArray(i)){var a=i;a.map(function(t){t.destroy()})}else{i.destroy()}}this.$el.remove()},updateDimensions:function(t){var e=findMinWidth(this.$el);var n=findMinHeight(this.$el);if(this.$el.prop("tagName")!=="IMG"){if(!t||e!==0){stream.push(this.minWidth,e)}if(!t||n!==0){stream.push(this.minHeight,n)}}}}})};var a=el("a");var button=el("button");var div=el("div");var form=el("form");var iframe=el("iframe");var img=el("img");var input=el("input");var li=el("li");var option=el("option");var select=el("select");var textarea=el("textarea");var ul=el("ul");var rootContext=function(){return{$el:$("body"),top:stream.once(0),topAccum:stream.once(0),left:stream.once(0),leftAccum:stream.once(0),scroll:windowScroll,width:windowWidth,height:stream.never(),backgroundColor:stream.once(transparent),fontColor:stream.once(black),brightness:stream.once(1)}};var rootComponent=function(t,e,n){var r=$.extend(rootContext(),e);var i=t.create(r);stream.pushAll(i.minHeight,r.height);if(n){stream.map(r.width,function(t){r.$el.css("width",t)});stream.map(r.height,function(t){r.$el.css("height",t)})}return i};var stream=stream||stream;var add=function(t,e){return t+e};var mathMax=function(t,e){return Math.max(t,e)};var mathMin=function(t,e){return Math.min(t,e)};var passThroughToFirst=function(t,e,n){stream.pushAll(n.minHeight,t.minHeight);stream.pushAll(n.minWidth,t.minWidth);return[{width:e.width,height:e.height,top:stream.once(0),left:stream.once(0)}]};var unit=function(t){return function(e){return e+t}};var px=unit("px");var url=function(t){return'url("'+t+'")'};var debugPrintHeight=function(t){stream.map(t.minHeight,function(t){console.log(t);console.log((new Error).stack)})};var debugPrintWidth=function(t){stream.map(t.minWidth,function(t){console.log(t);console.log((new Error).stack)})};var $$=function(t){return function(){var e=Array.prototype.slice.call(arguments);return function(n){n.$el[t].apply(n.$el,e);if(n.$el.hasClass("text")||n.$el.hasClass("paragraph")||n.$el.hasClass("image")||"BUTTON"===n.$el.prop("tagName")||"INPUT"===n.$el.prop("tagName")||"TEXTAREA"===n.$el.prop("tagName")){n.updateDimensions(true);if(!n.$el.hasClass("waiting-for-width")){n.$el.addClass("waiting-for-width");var r=findMinWidth(n.$el);var i=1e3;var a=1.1;var o=function(t){return function(){var e=findMinWidth(n.$el);if(e!==r){n.updateDimensions(true);n.$el.removeClass("waiting-for-width")}else{setTimeout(o(t*a),t)}}};setTimeout(o(i))}}}}};var $addClass=$$("addClass");var $css=$$("css");var $attr=$$("attr");var $prop=$$("prop");var $cssC=liftCF($css);var chooseHeightFromWidth=function(t,e){var n=false;stream.onValue(e.width,function(e){if(!n){n=true;setTimeout(function(){var r=findOptimalHeight(t.$el,e);stream.push(t.minHeight,r);n=false})}})};var $html=function(t,e){return function(n,r){n.$el.html(t);chooseHeightFromWidth(n,r);if(e){n.updateDimensions()}}};var windowWidth=stream.never();var windowHeight=stream.never();var updateWindowWidth=function(){stream.push(windowWidth,document.documentElement.clientWidth)};var updateWindowHeight=function(){stream.push(windowHeight,window.innerHeight)};$(updateWindowWidth);$(updateWindowHeight);$(window).on("resize",function(){updateWindowWidth();updateWindowHeight()});var windowResize=stream.once(null);$(window).on("resize",function(t){stream.push(windowResize,t)});var windowScroll=stream.never();$(window).on("scroll",function(){stream.push(windowScroll,window.scrollY)});stream.push(windowScroll,window.scrollY);var windowHash=stream.never();$(window).on("hashchange",function(){stream.push(windowHash,location.pathname)});stream.push(windowHash,location.pathname);var withMinWidth=function(t,e){return function(n){stream.push(n.minWidth,t);if(e){stream.end(n.minWidth)}}};var withMinHeight=function(t,e){return function(n){stream.push(n.minHeight,t);if(e){stream.end(n.minHeight)}}};var adjustMinSize=function(t){return function(e){return div.all([child(e),wireChildren(function(e,n,r){stream.pushAll(stream.map(r.minWidth,function(e){return t.mw(e)}),e.minWidth);stream.pushAll(stream.map(r.minHeight,function(e){return t.mh(e)}),e.minHeight);return[{top:stream.once(0),left:stream.once(0),width:n.width,height:n.height}]})])}};var link=function(t){t.$el.css("cursor","pointer").css("pointer-events","all")};var componentName=function(t){return function(e){e.$el.addClass(t)}};var onThis=function(t){return function(e){return function(n){var r=false;n.$el.on(t,function(t){if(!r){return e(t,function(){r=true;return function(){r=false}},n)}})}}};var changeThis=onThis("change");var clickThis=onThis("click");var inputPropertychangeThis=onThis("input propertychange");var keydownThis=onThis("keydown");var keyupThis=onThis("keyup");var mousedownThis=onThis("mousedown");var mousemoveThis=onThis("mousemove");var mouseoverThis=onThis("mouseover");var mouseoutThis=onThis("mouseout");var mouseupThis=onThis("mouseup");var submitThis=onThis("submit");var hoverThis=function(t){return function(e){t(false,e);e.$el.on("mouseover",function(n){t(true,e,n)});e.$el.on("mouseout",function(n){t(false,e,n)})}};var hoverStream=function(t,e){e=e||function(t){return t};return function(n){n.$el.css("pointer-events","initial");n.$el.on("mouseover",function(n){stream.push(t,e(n));n.stopPropagation()});$("body").on("mouseover",function(n){stream.push(t,e(false))})}};var cssStream=function(t,e){return function(n){stream.map(e,function(e){n.$el.css(t,e)})}};var withBackgroundColor=function(t,e){if(!stream.isStream(t)){t=stream.once({backgroundColor:t,fontColor:e})}return function(e,n){stream.map(t,function(t){var e=t.backgroundColor;var r=t.fontColor;stream.push(n.backgroundColor,e);setTimeout(function(){setTimeout(function(){var t=e.a*colorBrightness(e)+(1-e.a)*n.brightness.lastValue;stream.push(n.fontColor,r||(t>.5?black:white))})})})}};var withFontColor=function(t){return function(e,n){stream.push(n.fontColor,t)}};var hoverColor=function(t,e,n,r){t=colorString(t||transparent);e=colorString(e||t);n=colorString(n||black);r=colorString(r||n);return hoverThis(function(i,a){a.$el.css("background-color",i?e:t);a.$el.css("color",i?r:n)})};var keepAspectRatioCorner=function(t){t=t||{};return function(e){return div.all([$css("overflow","hidden"),child(e),wireChildren(function(e,n,r){stream.pushAll(r.minWidth,e.minWidth);stream.pushAll(r.minHeight,e.minHeight);var i={top:stream.create(),left:stream.create(),width:stream.create(),height:stream.create()};stream.combine([r.minWidth,r.minHeight,n.width,n.height],function(e,n,r,a){var o=e/n;var u=r/a;if(!t.fillSpace&&u>o||t.fillSpace&&u<o){var s=a*o;var h;if(t.left){h=0}else if(t.right){h=r-s}else{h=(r-s)/2}stream.push(i.top,0);stream.push(i.left,h);stream.push(i.width,s);stream.push(i.height,a)}else{var l=r/o;var c;if(t.top){c=0}else if(t.bottom){c=a-l}else{c=(a-l)/2}stream.push(i.top,c);stream.push(i.left,0);stream.push(i.width,r);stream.push(i.height,l)}});return[i]})])}};var keepAspectRatio=keepAspectRatioCorner();var keepAspectRatioFill=keepAspectRatioCorner({fillSpace:true});var image=function(t){var e=t.src&&t.src.map?t.src:stream.once(t.src);return img.all([componentName("image"),$css("pointer-events","all"),function(n,r){stream.map(e,function(t){n.$el.prop("src",t)});n.$el.css("display","none");n.$el.on("load",function(){n.$el.css("display","");var e=n.$el[0].naturalWidth;var i=n.$el[0].naturalHeight;var a=e/i;var o=t.minWidth||t.chooseWidth||e;var u=t.minHeight||t.chooseHeight||o/a;stream.push(n.minWidth,o);stream.push(n.minHeight,u);var s,h;if(t.minWidth!==undefined&&t.minWidth!==null){s=t.minWidth;h=s/a;stream.push(n.minWidth,s);stream.push(n.minHeight,h)}else if(t.minHeight!==undefined&&t.minHeight!==null){h=t.minHeight;s=h*a;stream.push(n.minWidth,s);stream.push(n.minHeight,h)}else if(t.useNativeWidth){stream.push(n.minWidth,e);stream.push(n.minHeight,i)}else{stream.push(n.minWidth,e)}if(!t.useNativeWidth){stream.pushAll(stream.map(r.width,function(t){return t/a}),n.minHeight)}})}])};var linkTo=function(t,e){return a.all([$prop("href",t),child(e.all([$css("pointer-events","initial")])),wireChildren(passThroughToFirst)])};var nothing=div.all([componentName("nothing"),withMinHeight(0),withMinWidth(0)]);var text=function(t){if(!stream.isStream(t)){t=stream.once(t)}return div.all([componentName("text"),$css("pointer-events","all"),$css("white-space","nowrap"),function(e,n){chooseHeightFromWidth(e,n);stream.onValue(t,function(t){if(t){while(t.indexOf(" ")!==-1){t=t.replace(" ","&nbsp;")}}e.$el.html(t);stream.push(e.minWidth,findMinWidth(e.$el))})}])};var faIcon=function(t){return text('<i class="fa fa-'+t+'"></i>')};var paragraph=function(t,e){if(!stream.isStream(t)){t=stream.once(t)}e=e||0;return div.all([componentName("paragraph"),$css("pointer-events","all"),function(n,r){chooseHeightFromWidth(n,r);n.updateDimensions=function(){stream.push(n.minWidth,findScrollWidth(n.$el,e))};stream.onValue(t,function(t){n.$el.html(t);n.updateDimensions()});stream.combine([t,r.width],function(t,e){var r=findOptimalHeight(n.$el,e);stream.push(n.minHeight,r)})}])};var ignoreSurplusWidth=function(t,e){return e};var ignoreSurplusHeight=function(t,e){return e};var centerSurplusWidth=function(t,e){var n=e[e.length-1];var r=t-(n.left+n.width);var i=r/e.length;e.map(function(t,e){t.left+=r/2});return e};var evenSplitSurplusWidth=function(t,e){var n=e[e.length-1];var r=t-(n.left+n.width);var i=r/e.length;e.map(function(t,e){t.width+=i;t.left+=e*i});return e};var evenSplitSurplusWidthWithMinPerRow=function(t){return function(e,n){var r=n[n.length-1];var i=e-(r.left+r.width);var a=e/Math.max(t,n.length);n.map(function(t,e){t.width=a;t.left=e*a});r=n[n.length-1];i=e-(r.left+r.width);a=i/n.length;n.map(function(t,e){t.left+=i/2});return n}};var justifySurplusWidth=function(t,e){var n=e[e.length-1];var r=t-(n.left+n.width);e.map(function(t,n){for(var i=0;i<n;i++){t.left+=r/(e.length-1)}});return e};var justifyAndCenterSurplusWidth=function(t,e){var n=e[e.length-1];var r=t-(n.left+n.width);e.map(function(t,n){t.left+=n*r/e.length+r/(2*e.length)});return e};var surplusWidthAlign=function(t){return function(e,n){var r=n[n.length-1];var i=e-(r.left+r.width);n.map(function(e,n){e.left+=t*i});return n}};var surplusWidthAlignLeft=surplusWidthAlign(0);var surplusWidthAlignCenter=surplusWidthAlign(.5);var surplusWidthAlignRight=surplusWidthAlign(1);var superSurplusWidth=function(t,e){var n=e[e.length-1];var r=t-(n.left+n.width);if(e.length===1){if(r<e[0].width){return evenSplitSurplusWidth(t,e)}else{return e}}if(e.length===2){return justifyAndCenterSurplusWidth(t,e)}return justifySurplusWidth(t,e)};var giveToNth=function(t){return function(e,n){var r=n[n.length-1];var i=e-(r.left+r.width);n.map(function(e,r){if(r===t||r===n.length-1&&t>=n.length){e.width+=i}else if(r>t){e.left+=i}});return n}};var giveToFirst=giveToNth(0);var giveToSecond=giveToNth(1);var giveToThird=giveToNth(2);var centerSurplusHeight=function(t,e){var n=e[e.length-1];var r=t-(n.top+n.height);e.map(function(t,e){t.top+=r/2});return e};var giveHeightToNth=function(t){return function(e,n){var r=n[n.length-1];var i=e-(r.top+r.height);n.map(function(e,r){if(r===t||r===n.length-1&&t>=n.length){e.height+=i}else if(r>t){e.top+=i}});return n}};var giveHeightToLast=function(t,e){var n=e.length-1;var r=e[e.length-1];var i=t-(r.top+r.height);e.map(function(t,r){if(r===n||r===e.length-1&&n>=e.length){t.height+=i}else if(r>n){t.top+=i}});return e};var slideshow=function(t,e){t.gutterSize=t.gutterSize||0;t.leftTransition=t.leftTransition||"none";t.alwaysFullWidth=t.alwaysFullWidth||false;return div.all([$css("overflow","hidden"),componentName("slideshow"),children(e.map(function(e){return e.all([$css("transition","left "+t.leftTransition)])})),wireChildren(function(e,n,r){var i=stream.combine(r.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t});stream.onValue(i,function(n){stream.push(e.minWidth,n.reduce(add,t.gutterSize*(r.length-1)))});var a=r.map(function(){return{top:stream.once(0),left:stream.never(),width:stream.never(),height:n.height}});stream.all([t.selectedS,n.width,i],function(e,n,r){var i=0;var o=0;var u=0;var s=r.map(function(r,a){r=t.alwaysFullWidth?n:r;if(e===a){i=u+t.gutterSize*a;o=r}var s={left:u+t.gutterSize*a,width:r};u+=r;return s});var h=(n-o)/2-i;s.map(function(t){t.left+=h});s.map(function(t,e){var n=a[e];stream.push(n.left,t.left);stream.push(n.width,t.width)})});stream.pushAll(stream.combine(r.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);var e=t.reduce(mathMax,0);a.map(function(t){stream.push(t.height,e)});return e}),e.minHeight);return[a]})])};var slideshowVertical=function(t,e){t.gutterSize=t.gutterSize||0;t.topTransition=t.topTransition||"none";t.alwaysFullHeight=t.alwaysFullHeight||false;return div.all([$css("overflow","hidden"),componentName("slideshow"),children(e.map(function(e){return e.all([$css("transition","top "+t.topTransition)])})),wireChildren(function(e,n,r){var i=stream.combine(r.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t});stream.onValue(i,function(t){stream.push(e.minHeight,t.reduce(mathMax,0))});var a=r.map(function(t){return{top:stream.never(),left:stream.once(0),width:n.width,height:t.minHeight}});stream.all([t.selected,n.height,i],function(e,n,r){var i=0;var o=0;var u=0;var s=r.map(function(r,a){r=t.alwaysFullHeight?n:r;if(e===a){i=u+t.gutterSize*a;o=r}var s={top:u+t.gutterSize*a,height:r};u+=r;return s});var h=(n-o)/2-i;s.map(function(t){t.top+=h});s.map(function(t,e){var n=a[e];stream.push(n.top,t.top);stream.push(n.height,t.height)})});stream.pushAll(stream.combine(r.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);var e=t.reduce(mathMax,0);return e}),e.minWidth);return[a]})])};var sideBySide=function(t,e){t.gutterSize=t.gutterSize||0;t.handleSurplusWidth=t.handleSurplusWidth||ignoreSurplusWidth;return div.all([componentName("sideBySide"),children(e),wireChildren(function(e,n,r){var i=stream.combine(r.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t});stream.onValue(i,function(n){stream.push(e.minWidth,n.reduce(add,t.gutterSize*(r.length-1)))});var a=r.map(function(){return{top:stream.once(0),left:stream.never(),width:stream.never(),height:n.height}});stream.all([n.width,i],function(e,n){var r=0;var i=n.map(function(e,n){var i={left:r+t.gutterSize*n,width:e};r+=e;return i});i=t.handleSurplusWidth(e,i);i.map(function(t,e){var n=a[e];stream.push(n.left,t.left);stream.push(n.width,t.width)})});stream.pushAll(stream.combine(r.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}),e.minHeight);return[a]})])};var slider=function(t,e){t=t||{};t.leftTransition=t.leftTransition||"0s";var n=stream.once(false);var r={left:"left",right:"right"};var i=stream.once({index:0,edge:"left"});var a=0;return div.all([componentName("slider"),$css("overflow-x","hidden"),$css("cursor","move"),children(e),wireChildren(function(e,r,o){var u=stream.combine(o.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t});var s=stream.map(u,function(t){return t.reduce(add,0)});stream.onValue(u,function(t){stream.push(e.minWidth,t.reduce(mathMax,0))});stream.pushAll(stream.combine(o.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}),e.minHeight);var h=stream.combine([r.width,u,i,n],function(t,e,n,r){var i=n.edge==="left"?0:t;e.map(function(t,e){if(e<n.index){i-=t}if(n.edge==="right"&&e===n.index){i-=t}});if(r!==false){i+=r}return i});var l=stream.combine([u,h],function(t,e){return t.reduce(function(t,e){t.arr.push(t.lastValue);t.lastValue+=e;return t},{arr:[],lastValue:e}).arr});e.$el.css("user-select","none");e.$el.on("mousedown",function(t){t.preventDefault();stream.push(n,0);o.map(function(t){t.$el.css("transition","left 0s")})});var c=function(e){o.map(function(e){e.$el.css("transition","left "+t.leftTransition)});var a=u.lastValue;var s=r.width.lastValue;var l=n.lastValue;if(!l){return}var c=h.lastValue;var m=a.reduce(function(t,e){var n=t[t.length-1];t.push(n-e);return t},[0]);var f=m.reduce(function(t,e,n){var r=Math.abs(e-c);var i=Math.abs(e-(c-s));return{left:r<t.left.distance?{distance:r,index:n}:t.left,right:i<t.right.distance?{distance:i,index:n-1}:t.right}},{left:{distance:Number.MAX_VALUE,index:-1},right:{distance:Number.MAX_VALUE,index:-1}});if(f.left.distance<=f.right.distance){stream.push(i,{index:f.left.index,edge:"left"})}else{stream.push(i,{index:f.right.index,edge:"right"})}stream.push(n,false);e.preventDefault()};e.$el.on("mouseup",c);e.$el.on("mouseout",c);e.$el.on("mousemove",function(t){var e=n.lastValue;var i=s.lastValue;var o=r.width.lastValue;var u=h.lastValue;if(e!==false){var l=t.clientX-a;var c=u+l;c=Math.min(0,c);if(i>o){c=Math.max(o-i,c)}l=c-u;e=e+l;stream.push(n,e)}a=t.clientX});return[o.map(function(t,e){return{top:stream.once(0),left:stream.map(l,function(t){return t[e]}),width:t.minWidth,height:r.height}})]})])};var stack2=function(t,e){t.gutterSize=t.gutterSize||0;t.handleSurplusHeight=t.handleSurplusHeight||ignoreSurplusHeight;return div.all([componentName("stack2"),children(e),wireChildren(function(e,n,r){var i=stream.combine(r.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t});stream.onValue(i,function(n){stream.push(e.minHeight,n.reduce(add,t.gutterSize*(r.length-1)))});var a=r.map(function(){return{top:stream.create(),left:stream.once(0),width:n.width,height:stream.never()}});stream.all([n.height,i],function(e,n){var r=0;var i=n.map(function(e,n){var i={top:r+t.gutterSize*n,height:e};r+=e;return i});i=t.handleSurplusHeight(e,i);i.map(function(t,e){var n=a[e];stream.push(n.top,t.top);stream.push(n.height,t.height)})});stream.pushAll(stream.combine(r.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}),e.minWidth);return[a]})])};var intersperse=function(t,e){var n=[];stream.map(t,function(t){stream.push(n,t);stream.push(n,e)});n.pop();return n};var stackTwo=function(t,e){t.gutterSize=t.gutterSize||0;t.align=t.align||"left";return div.all([componentName("stack"),children(e),wireChildren(function(e,n,r){var i=r[0];var a=r[1];var o=t.gutterSize;var u=[];stream.push(e.minHeight,0);stream.push(e.minWidth,0);stream.pushAll(stream.combine([i.minHeight,a.minHeight],function(t,e){return t+e+o}),e.minHeight);stream.pushAll(stream.combine([i.minWidth,a.minWidth],function(t,e){return Math.max(t,e)}),e.minWidth);return[[{top:stream.once(0),left:stream.once(0),width:n.width,height:i.minHeight},{top:stream.map(i.minHeight,function(t){return t+o}),left:stream.once(0),width:n.width,height:a.minHeight}]]})])};var stack=function(t,e){t.gutterSize=t.gutterSize||0;t.collapseGutters=t.collapseGutters||false;t.align=t.align||"left";if(e.length===0){e=[nothing]}return div.all([componentName("stack"),children(e),wireChildren(function(e,n,r){var i=t&&t.gutterSize||0;var a=function(e){if(e.length===0){return stream.once(0)}return stream.combine(e.map(function(e,r){var i;if(t&&t.mhs&&t.mhs[r]){var a=t.mhs[r](n);return stream.combine([e.minHeight,a],mathMax)}else{return e.minHeight}return e.minHeight}),function(){var e=Array.prototype.slice.call(arguments);var n=e.reduce(function(e,n){return e+n+(t.collapseGutters&&n===0?0:i)},-i);return n})};var o=[];r.reduce(function(e,r,u){var s=stream.map(a(e),function(e){return e+(u===0||t.collapseGutters&&e===0?0:i)});var h;if(t&&t.mhs&&t.mhs[e.length]){var l=t.mhs[e.length](n);h=stream.combine([r.minHeight,l],mathMax)}else{h=r.minHeight}o.push({top:s,left:stream.once(0),width:n.width,height:h});e.push(r);return e},[]);stream.pushAll(a(r),e.minHeight);stream.pushAll(stream.combine(r.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}),e.minWidth);return[o]})])};var adjustPosition=function(t,e){var n=t.top||0;var r=t.left||0;var i=t.expand;return div.all([componentName("adjustPosition"),child(e),wireChildren(function(t,e,a){stream.pushAll(stream.map(a.minWidth,function(t){return t+i?r:0}),t.minWidth);stream.pushAll(stream.map(a.minHeight,function(t){return t+i?n:0}),t.minHeight);return[{top:stream.map(e.top,function(t){return t+n}),left:stream.map(e.left,function(t){return t+r}),width:e.width,height:e.height}]})])};var padding=function(t,e){var n=t.all||0,r=t.all||0,i=t.all||0,a=t.all||0;if($.isNumeric(t)){n=r=i=a=t}else{for(var o in t){var u=o.toLowerCase();if(t[o]!==null){if(u.indexOf("top")!==-1){n=t[o]}if(u.indexOf("bottom")!==-1){r=t[o]}if(u.indexOf("left")!==-1){i=t[o]}if(u.indexOf("right")!==-1){a=t[o]}}}}return div.all([componentName("padding"),child(e),wireChildren(function(t,e,o){stream.pushAll(stream.map(o.minWidth,function(t){return t+i+a}),t.minWidth);stream.pushAll(stream.map(o.minHeight,function(t){return t+n+r}),t.minHeight);return[{top:stream.once(n),left:stream.once(i),width:stream.map(e.width,function(t){return t-i-a}),height:stream.map(e.height,function(t){return t-n-r})}]})])};var margin=function(t){return function(e){return padding(t,e)}};var expandoStream=function(t,e){var n=stream.create();var r=stream.create();var i=stream.create();var a=stream.create();stream.map(t,function(t){var e=t.all||0,o=t.all||0,u=t.all||0,s=t.all||0;if($.isNumeric(t)){e=o=u=s=t}else{for(var h in t){var l=h.toLowerCase();if(t[h]!==null){if(l.indexOf("top")!==-1){e=t[h]}if(l.indexOf("bottom")!==-1){o=t[h]}if(l.indexOf("left")!==-1){u=t[h]}if(l.indexOf("right")!==-1){s=t[h]}}}}stream.push(n,e);stream.push(r,o);stream.push(i,u);stream.push(a,s)});return div.all([componentName("expando-stream"),child(e),wireChildren(function(t,e,o){var u=t.newCtx();stream.combine([o.minWidth,i,a],function(e,n,r){stream.push(t.minWidth,e)});stream.combine([i,a,e.width],function(t,e,n){stream.push(u.left,t);stream.push(u.width,n-t-e)});stream.combine([o.minHeight,n,r],function(e,n,r){stream.push(t.minHeight,e)});stream.combine([n,r,e.height],function(t,e,n){stream.push(u.top,t);stream.push(u.height,n-t-e)});return[u]})])};var alignLRM=function(t){return div.all([componentName("alignLRM"),child(t.middle||nothing),child(t.left||nothing),child(t.right||nothing),wireChildren(function(t,e,n,r,i){var a=stream.combine([n,r,i].map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);var e=t.reduce(function(t,e){return Math.max(t,e)},0);return e});stream.pushAll(a,t.minHeight);stream.pushAll(stream.combine([n,r,i].map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);var e=t.reduce(function(t,e){return t+e},0);return e}),t.minWidth);var o=function(t,e){return stream.combine([t,e],mathMin)};var u=o(e.width,n.minWidth);var s=o(e.width,r.minWidth);var h=o(e.width,i.minWidth);return[{top:stream.once(0),left:stream.combine([e.width,u],function(t,e){return(t-e)/2}),width:u,height:e.height},{top:stream.once(0),left:stream.once(0),width:s,height:e.height},{top:stream.once(0),left:stream.combine([e.width,h],function(t,e){return t-e}),width:h,height:e.height}]})])};var alignTBM=function(t){t.middle=t.middle||nothing;t.bottom=t.bottom||nothing;t.top=t.top||nothing;return div.all([componentName("alignTBM"),child(t.middle),child(t.bottom),child(t.top),wireChildren(function(t,e,n,r,i){var a=stream.combine([n,r,i].map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);var e=t.reduce(function(t,e){return Math.max(t,e)},0);return e});stream.pushAll(a,t.minWidth);stream.pushAll(stream.combine([n,r,i].map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);var e=t.reduce(function(t,e){return t+e},0);return e}),t.minHeight);return[{top:stream.combine([e.height,n.minHeight],function(t,e){return(t-e)/2}),left:stream.once(0),width:e.width,height:n.minHeight},{top:stream.combine([e.height,r.minHeight],function(t,e){return t-e}),left:stream.once(0),width:e.width,height:r.minHeight},{top:stream.once(0),left:stream.once(0),width:e.width,height:i.minHeight}]})])};var invertOnHover=function(t){var e=stream.once(false,"invert");
var n=function(t,n){return stream.combine([e,t,n],function(t,e,n){return t?n:e},"choose stream")};return div.all([componentName("invert-on-hover"),child(t.and($css("transition","background-color 0.2s linear, color 0.1s linear"))),wireChildren(function(t,e,r){stream.pushAll(r.minHeight,t.minHeight);stream.pushAll(r.minWidth,t.minWidth);return[{backgroundColor:n(e.backgroundColor,e.fontColor),fontColor:n(e.fontColor,e.backgroundColor),top:stream.once(0),left:stream.once(0),width:e.width,height:e.height}]}),mouseoverThis(function(){stream.push(e,true)}),mouseoutThis(function(){stream.push(e,false)})])};var border=function(t,e,n){var r=e.left||e.all||0;var i=e.right||e.all||0;var a=e.top||e.all||0;var o=e.bottom||e.all||0;var u=e.radius||0;if(!t.onValue){t=stream.once(t)}var s=stream.map(t,colorString);return div.all([componentName("border"),child(div.all([componentName("border-child"),$css("border-radius",px(u)),child(n),wireChildren(passThroughToFirst)])),function(t){stream.map(s,function(e){t.$el.css("border-left",px(r)+" solid "+e);t.$el.css("border-right",px(i)+" solid "+e);t.$el.css("border-top",px(a)+" solid "+e);t.$el.css("border-bottom",px(o)+" solid "+e)})},wireChildren(function(t,e,n){stream.pushAll(stream.map(n.minWidth,function(t){return t+r+i}),t.minWidth);stream.pushAll(stream.map(n.minHeight,function(t){return t+a+o}),t.minHeight);return[{top:stream.once(0),left:stream.once(0),width:stream.map(e.width,function(t){return t-r-i}),height:stream.map(e.height,function(t){return t-a-o})}]})])};var componentStream=function(t){var e;return div.all([componentName("component-stream"),function(n,r){var i=n.newCtx();stream.push(i.top,0);stream.push(i.left,0);stream.pushAll(r.width,i.width);stream.pushAll(r.height,i.height);var a=stream.create();stream.pushAll(t,a);stream.map(a,function(t){var r=function(t){if(e){e.destroy()}e=t.create(i);e.$el.css("transition","inherit");stream.pushAll(e.minWidth,n.minWidth);stream.pushAll(e.minHeight,n.minHeight)};if(t.then){t.then(function(t){r(t)},function(t){console.error("child components failed to load");console.log(t)})}else{r(t)}});return function(){stream.end(localCstream);if(e){e.destroy()}}}])};var componentStreamWithExit=function(t,e){var n;return div.all([componentName("component-stream"),function(r,i){var a=r.newCtx();stream.push(a.top,0);stream.push(a.left,0);stream.pushAll(i.width,a.width);stream.pushAll(i.height,a.height);var o=stream.create();stream.pushAll(t,o);stream.map(o,function(t){var i=function(t){if(n){(function(t){e(t).then(function(){t.destroy()})})(n)}n=t.create(a);n.$el.css("transition","inherit");stream.pushAll(n.minWidth,r.minWidth);stream.pushAll(n.minHeight,r.minHeight)};if(t.then){t.then(function(t){i(t)},function(t){console.error("child components failed to load");console.log(t)})}else{i(t)}});return function(){stream.end(localCstream);if(n){n.destroy()}}}])};var promiseComponent=function(t){var e=stream.once(nothing);t.then(function(t){stream.push(e,t)},function(t){console.log(t)}).catch(function(t){console.log(t)});return componentStream(e)};var toggleComponent=function(t,e){return componentStream(stream.map(e,function(e){return t[e]}))};var modalDialog=function(t){return function(e,n){var r=stream.once(false);stream.pushAll(e,r);n=n||0;return div.all([$css("z-index",100),componentName("toggle-height"),child(t),wireChildren(function(t,e,i){stream.push(t.minWidth,0);stream.push(t.minHeight,0);var a=i.$el;a.css("position","fixed");a.css("transition",a.css("transition")+", opacity "+n+"s");a.css("display","none");a.css("pointer-events","initial");stream.onValue(r,function(t){if(t){a.css("display","");setTimeout(function(){a.css("opacity",1)},100)}else{a.css("opacity",0);setTimeout(function(){a.css("display","none")},n*1e3)}});return[{width:stream.map(windowWidth,function(){return window.innerWidth}),height:windowHeight,left:stream.once(0),top:stream.once(0)}]})])}};var toggleHeight=function(t){var e=stream.once(false);stream.pushAll(t,e);return function(t){return div.all([$css("overflow","hidden"),componentName("toggle-height"),child(t),wireChildren(function(t,n,r){stream.pushAll(r.minWidth,t.minWidth);stream.pushAll(stream.combine([r.minHeight,e],function(t,e){return e?t:0}),t.minHeight);return[{top:stream.once(0),left:stream.once(0),width:n.width,height:n.height}]})])}};var dropdownPanel=function(t,e,n,r){r=r||{};r.transition=r.transition||"0.5s";return div.all([componentName("dropdown-panel"),child(div.all([child(e),wireChildren(function(t,e,i){stream.pushAll(i.minWidth,t.minWidth);stream.pushAll(i.minHeight,t.minHeight);i.$el.css("transition","top "+r.transition);t.$el.css("pointer-events","none");i.$el.css("pointer-events","initial");i.$el.css("z-index","1000");return[{width:e.width,height:i.minHeight,top:stream.combine([n,i.minHeight],function(t,e){return t?0:-e}),left:stream.once(0)}]}),$css("overflow","hidden")])),child(t),wireChildren(function(t,e,n,i){stream.pushAll(stream.combine([n.minWidth,i.minWidth],Math.max),t.minWidth);stream.pushAll(i.minHeight,t.minHeight);if(r.panelHeightS){stream.pushAll(n.minHeight,r.panelHeightS)}return[{width:e.width,height:n.minHeight,top:i.minHeight,left:stream.once(0)},{width:e.width,height:i.minHeight,top:stream.once(0),left:stream.once(0)}]})])};var fixedHeaderBody=function(t,e,n){t.transition=t.transition||"0.5s";return div.all([componentName("fixedHeaderBody"),child(n),child(e),wireChildren(function(e,n,r,i){i.$el.css("position","fixed");setTimeout(function(){i.$el.css("transition","height "+t.transition);r.$el.css("transition","top "+t.transition)});stream.pushAll(stream.map(stream.combine([r,i],function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(add,0)}),e.minHeight);stream.pushAll(stream.map(stream.combine([r,i],function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}),e.minWidth);return[{top:i.minHeight,left:stream.once(0),width:n.width,height:r.minHeight},{top:stream.once(0),left:stream.once(0),width:n.width,height:i.minHeight}]})])};var makeSticky=function(t){return div.all([componentName("stickyHeaderBody"),child(t),wireChildren(function(t,e,n){stream.pushAll(n.minWidth,t.minWidth);stream.pushAll(n.minHeight,t.minHeight);return[{top:stream.once(0),left:stream.combine([n.minHeight,e.scroll,e.top,e.left,e.leftAccum],function(t,e,r,i,a){var o=n.$el;if(r>e){o.css("position","absolute");o.css("transition","");return 0}else if(r<e){var u=i+a;o.css("position","fixed");o.css("left",px(u));setTimeout(function(){o.css("transition","inherit")},20);return u}}),width:e.width,height:e.height}]})])};var stickyHeaderBody=function(t,e,n){return div.all([componentName("stickyHeaderBody"),child(t),child(n),child(e),wireChildren(function(t,e,n,r,i){stream.pushAll(stream.map(stream.combine([n,r,i],function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(add,0)}),t.minHeight);var a=false;return[{top:stream.once(0),left:stream.once(0),width:e.width,height:n.minHeight},{top:stream.combine([n.minHeight,i.minHeight],add),left:stream.once(0),width:e.width,height:r.minHeight},{top:stream.combine([n.minHeight,e.scroll,e.topAccum],function(t,e,n){var r=i.$el;t=Math.floor(t);if(t>e+n){r.css("position","absolute");r.css("transition","");if(a){window.scrollTo(0,t+n)}a=false;return t}else if(t<e+n){r.css("position","fixed");setTimeout(function(){r.css("transition","inherit")},20);if(!a){window.scrollTo(0,t+n)}a=true;return n}}),left:stream.once(0),width:e.width,height:i.minHeight}]})])};var grid=function(t,e){t.gutterSize=t.gutterSize||0;t.handleSurplusWidth=t.handleSurplusWidth||ignoreSurplusWidth;t.handleSurplusHeight=t.handleSurplusHeight||ignoreSurplusHeight;t.maxPerRow=t.maxPerRow||0;return padding(t.outerGutter?t.gutterSize:0,div.all([componentName("grid"),children(e),wireChildren(function(e,n,r){if(r.length===0){stream.push(e.minWidth,0);stream.push(e.minHeight,0)}var i=stream.combine(r.map(function(t){return t.minWidth}),function(){return Array.prototype.slice.call(arguments)});var a=stream.combine(r.map(function(t){return t.minHeight}),function(){return Array.prototype.slice.call(arguments)});stream.pushAll(stream.map(i,function(e){return e.reduce(function(e,n){return t.useFullWidth?e+n+t.gutterSize:Math.max(e,n)+t.gutterSize},-t.gutterSize)}),e.minWidth);var o=r.map(function(t){return{top:stream.never(),left:stream.never(),width:stream.never(),height:stream.never()}});var u=stream.combine([n.width,i],function(e,n){if(t.allSameWidth){var i=n.reduce(mathMax,0);for(var a=0;a<n.length;a++){n[a]=i}}var u=function(){return{cells:[],contexts:[],height:0}};var s=r.reduce(function(r,i,a){var s=r.rows;var h=r.currentRow;var l=n[a];var c=h.cells.reduce(function(e,n){return e+n+t.gutterSize},0);var m=Math.min(l,e);if(t.maxPerRow>0&&h.cells.length===t.maxPerRow||m>0&&m+c>e){s.push(h);h=u()}h.cells.push(m);h.contexts.push(o[a]);return{rows:s,currentRow:h}},{rows:[],currentRow:u()});var h=s.rows;h.push(s.currentRow);h.map(function(n,r){var i=0;var a=n.cells.map(function(e){var n={left:i,width:e};i+=e+t.gutterSize;return n});a=t.handleSurplusWidth(e,a,t,r);a.map(function(t,e){var r=n.contexts[e];stream.push(r.width,t.width)})});return h});var s=stream.combine([a,u],function(n,r){var i=0;r.map(function(t){t.height=0;t.cells.map(function(e,r){t.height=Math.max(t.height,n[i+r])});i+=t.cells.length});stream.push(e.minHeight,r.map(function(t){return t.height}).reduce(function(e,n){return e+n+t.gutterSize},-t.gutterSize));return r});stream.all([n.width,n.height,s],function(e,n,r){if(t.bottomToTop){r=r.slice(0).reverse()}var i=0;r=t.handleSurplusHeight(n,r,t);r.map(function(n,r){var a=0;var o=n.cells.map(function(e){var r={top:i,left:a,width:e,height:n.height};a+=e+t.gutterSize;return r});o=t.handleSurplusWidth(e,o,t,r);o.map(function(t,e){var r=n.contexts[e];stream.push(r.top,t.top);stream.push(r.left,t.left);stream.push(r.width,t.width);stream.push(r.height,t.height)});i+=n.height+t.gutterSize})});return[o]})]))};var backgroundImagePosition={fit:"fit",fill:"fill"};var withMinWidthStream=function(t,e){return div.all([componentName("with-min-width-stream"),child(e),wireChildren(function(e,n,r){if($.isFunction(t)){stream.pushAll(t(r,n),e.minWidth)}else{stream.pushAll(t,e.minWidth)}stream.pushAll(r.minHeight,e.minHeight);return[{top:stream.once(0),left:stream.once(0),width:n.width,height:n.height}]})])};var withMinHeightStream=function(t,e){return div.all([componentName("with-min-height-stream"),child(e),wireChildren(function(e,n,r){if($.isFunction(t)){stream.pushAll(t(r,n),e.minHeight)}else{stream.pushAll(t,e.minHeight)}stream.pushAll(r.minWidth,e.minWidth);return[{top:stream.once(0),left:stream.once(0),width:n.width,height:n.height}]})])};var minHeightAtLeast=function(t,e){return withMinHeightStream(function(e){return stream.map(e.minHeight,function(e){return Math.max(e,t)})},e)};var extendToWindowBottom=function(t,e){e=e||stream.once(0);return withMinHeightStream(function(t,n){return stream.combine([t.minHeight,n.top,n.topAccum,e,windowResize],function(t,e,n,r){return Math.max(t,window.innerHeight-e-n-r)})},t)};var atMostWindowBottom=function(t,e){e=e||stream.once(0);return withMinHeightStream(function(t,n){return stream.combine([t.minHeight,n.top,n.topAccum,e,windowResize],function(t,e,n,r){return Math.min(t,window.innerHeight-e-n-r)})},t)};var overlays=function(t){return div.all([children(t),wireChildren(function(t,e,n){var r=function(t){return stream.combine(t,function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)})};stream.pushAll(r(n.map(function(t){return t.minHeight})),t.minHeight);stream.pushAll(r(n.map(function(t){return t.minWidth})),t.minWidth);return[n.map(function(t){return{top:stream.once(0),left:stream.once(0),width:e.width,height:e.height}})]})])};var withBackground=function(t,e){return div.all([componentName("with-background"),child(t),child(e),wireChildren(function(t,e,n,r){stream.pushAll(r.minWidth,t.minWidth);stream.pushAll(r.minHeight,t.minHeight);var i={top:stream.once(0),left:stream.once(0),width:e.width,height:e.height};return[i,i]})])};var withBackgroundImage=function(t,e){var n=stream.once(t.aspectRatio||1);if(!t.src.map){t.src=stream.once(t.src)}return div.all([componentName("with-background-image"),$css("overflow","hidden"),child(img.all([$css("visibility","hidden"),function(e,r){stream.push(e.minWidth,0);stream.push(e.minHeight,0);stream.map(t.src,function(t){e.$el.prop("src",t)});e.$el.on("load",function(){var t=findMinWidth(e.$el);var r=findMinHeight(e.$el);var i=t/r;stream.push(n,i)});stream.all([r.width,r.height],function(){e.$el.css("visibility","")})}])),child(e),wireChildren(function(t,e,r,i){stream.pushAll(i.minWidth,t.minWidth);stream.pushAll(i.minHeight,t.minHeight);var a=t.newCtx();stream.push(e.top,0);stream.push(e.left,0);stream.pushAll(e.width,a.width);stream.pushAll(e.height,a.height);var o=t.newCtx();stream.push(o.top,0);stream.push(o.left,0);stream.all([n,e.width,e.height],function(t,e,n){var r=e/n;if(t<r){stream.push(o.width,e);stream.push(o.height,e/t)}else{stream.push(o.width,n*t);stream.push(o.height,n)}});return[o,a]})])};var table=function(t,e){t=t||{};var n=(t.paddingSize||0)*2;return div.all(stream.map(e,function(t){return children(t)})).all([componentName("table"),wireChildren(function(){var t=Array.prototype.slice.call(arguments);var e=t[0];var r=t[1];var i=t.slice(2);var a=stream.combine(i.reduce(function(t,e){stream.push(t,stream.combine(e.map(function(t){return t.minWidth}),function(){return Array.prototype.slice.call(arguments)}));return t},[]),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(function(t,e){return stream.map(e,function(e,n){return Math.max(t[n]||0,e)})},[])});stream.map(a,function(t){var r=t.reduce(function(t,e){return t+e+n},-n);stream.push(e.minWidth,r)});var o=i.reduce(function(t,e){stream.push(t,stream.combine(e.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}));return t},[]);stream.combine(o,function(){var t=Array.prototype.slice.call(arguments);var r=t.reduce(function(t,e){return t+e+n},-n);stream.push(e.minHeight,r)});return stream.map(o,function(t,e){return stream.map(i[e],function(t,r){return{width:stream.map(a,function(t){return t[r]}),height:o[e],top:stream.combine(o.slice(0,e).concat([stream.once(0)]),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(function(t,e){return t+e+n},-n)}),left:stream.map(a,function(t){return t.reduce(function(t,e,i){return t+(i<r?e+n:0)},0)})}})})})])};var tabs=function(t,e){var n=e||e.once(0);return stack({},[sideBySide({handleSurplusWidth:centerSurplusWidth},e.map(t,function(t,r){return alignTBM({bottom:toggleComponent([t.tab.left,t.tab.right,t.tab.selected],e.map(n,function(t){if(r<t){return 0}if(r>t){return 1}return 2})).all([link,clickThis(function(){e.push(n,r)})])})})),componentStream(e.map(n,function(e){return t[e].content}))])};var matchStrings=function(t){return function(e){for(var n=0;n<t.length;n++){var r=t[n];if(e.indexOf(r.string)===0){return r.router(e.substring(r.string.length))}}}};var routeToComponent=function(t){return function(){return t}};var routeToComponentF=function(t){return function(){return t()}};var routeToFirst=function(t){return function(e){for(var n=0;n<t.length;n++){var r=t[n](e);if(r){return r}}}};var routeMatchRest=function(t){return function(e){return Q(e).then(t)}};var ignoreHashChange=false;var route=function(t,e){var n;return div.all([child(div.all([componentName("route"),function(r,i){stream.onValue(t,function(t){if(ignoreHashChange){ignoreHashChange=false;return}if(n){n.destroy()}Q.all([e(t)]).then(function(t){var e=t[0];n=e.create(i);n.$el.css("transition","inherit");stream.pushAll(n.minWidth,r.minWidth);stream.pushAll(n.minHeight,r.minHeight)},function(t){console.error("child components failed to load");console.log(t)})})}])),wireChildren(passThroughToFirst)])};