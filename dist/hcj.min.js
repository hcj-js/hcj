var color=function(t){return $.extend({r:0,g:0,b:0,a:1},t)};var multiplyColor=function(t){return function(n){return{r:Math.min(255,n.r*t),g:Math.min(255,n.g*t),b:Math.min(255,n.b*t),a:n.a}}};var desaturate=function(t){return function(n){var e=(n.r+n.g+n.b)/3;var i=1-t;return{r:i*n.r+t*e,g:i*n.g+t*e,b:i*n.b+t*e,a:n.a}}};var colorBrightness=function(t){return(t.r+t.g+t.b)/(255+255+255)};var colorString=function(t){return"rgba("+Math.floor(t.r)+","+Math.floor(t.g)+","+Math.floor(t.b)+","+t.a+")"};var rgbColorString=function(t){return"rgb("+Math.floor(t.r)+","+Math.floor(t.g)+","+Math.floor(t.b)+")"};var transparent=color({a:0});var black=color({r:0,g:0,b:0});var white=color({r:255,g:255,b:255});var Stream={create:function(){var t=false;var n=$.Deferred();var e;var i=[];var r=[];var o=function(r){n.resolve(r);if(!t&&e!==r){e=r;i.map(function(t){return t(r)})}};return{lastValue:function(){return e},map:function(t){var n=Stream.create();r.push(n);if(e!==undefined){n.push(t(e))}i.push(function(e){n.push(t(e))});return n},reduce:function(t,n){var o=Stream.once(n);r.push(o);if(e!==undefined){o.push(t(o.lastValue(),e))}i.push(function(n){o.push(t(o.lastValue(),n))});return o},filter:function(t){var n=Stream.create();r.push(n);if(e!==undefined){t(e,n.push)}i.push(function(e){t(e,n.push)});return n},onValue:function(t){return this.map(function(n){t(n);return true})},promise:n.promise(),prop:function(t){return this.map(function(n){return n[t]})},delay:function(t){var n=Stream.create();r.push(n);this.map(function(e){setTimeout(function(){n.push(e)},t)});return n},end:function(){r.map(function(t){t.end()});t=true},push:o,pushAll:function(t){this.onValue(function(n){t.push(n)})},test:function(){var t=arguments;var n=new Error;setTimeout(function(){if(e===undefined){t;n;debugger}},5e3);return this},cases:function(t,n){t.push(n);return Stream.combine(t,function(){var t=Array.prototype.slice.call(arguments);var n=t.pop();return t[n]})}}},once:function(t){var n=Stream.create();n.push(t);return n},never:function(){return Stream.create()},combine:function(t,n){var e=[];var i=Stream.create();var r=false;var o=new Error;var a=function(){if(!r){r=true;setTimeout(function(){o;r=false;for(var a=0;a<t.length;a++){if(e[a]===undefined){return}}i.push(n.apply(null,e))})}};t.reduce(function(t,n){n.onValue(function(n){e[t]=n;a()});return t+1},0);return i},all:function(t,n){return this.combine(t,function(){n.apply(null,arguments);return true})},combineObject:function(t){var n=Object.keys(t);var e={};var i=Stream.create();var r=false;var o=function(){if(!r){r=true;setTimeout(function(){r=false;for(var t=0;t<n.length;t++){var o=n[t];if(e[o]===undefined){return}}i.push($.extend({},e))})}};n.map(function(n,i){t[n].onValue(function(t){e[n]=t;o()})});return i},splitObject:function(t){var n=Object.keys(t);var e={};n.map(function(n){e[n]=Stream.once(t[n])});return e},fromPromise:function(t,n){var e=Stream.never();if(n){e.push(n)}t.then(function(t){e.push(t)});return e}};var child=function(t){if(!t||!t.create){console.error("faulty component")}return function(n){n.child(t)}};var children=function(t){t.map(function(t){if(!t||!t.create){console.error("faulty component")}});return function(n){n.children(t)}};var wireChildren=function(t){return function(n){n.wireChildren=t}};var component=function(t){var n={create:function(t){var n=this.build(t);n.wireChildren=n.wireChildren||function(){};var e=n.childComponentPs;var i=[];var r=e.map(function(t){if($.isArray(t)){var e=[];var r=t.map(function(t){var i=n.newCtx();e.push(i);return t.create(i)});i.push(e);return r}else{var o=n.newCtx();i.push(o);return t.create(o)}});n.childInstances=r;var o=n.wireChildren.apply(null,[n,t].concat(r))||[];var a=function(t,n,e){t=t||{};if(t.top){t.top.pushAll(e.top)}if(t.left){t.left.pushAll(e.left)}if(t.width){t.width.pushAll(e.width)}if(t.height){t.height.pushAll(e.height)}if(t.backgroundColor){t.backgroundColor.pushAll(e.backgroundColor)}if(t.fontColor){t.fontColor.pushAll(e.fontColor)}};for(var u=0;u<r.length;u++){var h=o[u]||{};var l=r[u];var c=i[u];if($.isArray(l)){for(var s=0;s<l.length;s++){a(h[s],l[s],c[s])}}else{a(h,l,c)}}return n},build:t,and:function(t){var n=this;var e=$.extend({},n);e.build=function(e){var i=n.build(e);var r=t(i,e);var o=i.destroy;if(r){i.destroy=function(){var t=r();if(t){t.then(function(){o.apply(i)})}else{o.apply(i)}}}return i};return e},all:function(t){return t.reduce(function(t,n){return t.and(n)},this)},compose:function(t){return t.reduce(function(t,n){return n(t)},this)}};return n};var liftC=function(t){return function(n){return n.and(t)}};var liftCF=function(t){return function(){var n=arguments;return function(e){return e.and(t.apply(null,n))}}};var findOptimalHeight=function(t,n){var e=$(".sandbox");var i=t.clone();i.css("height","").css("width",n).appendTo(e);var r=parseInt(i.css("height"));i.remove();return r};var findMinWidth=function(t){var n=$(".sandbox");var e=t.clone();e.css("width","").css("height","").appendTo(n);var i=parseInt(e.css("width"));e.remove();return i};var findScrollWidth=function(t,n){var e=$(".sandbox");var i=t.clone();i.css("width",n).css("height","").appendTo(e);var r=i[0].scrollWidth;i.remove();return r};var findMinHeight=function(t){var n=$(".sandbox");var e=t.clone();e.css("width","").css("height","").appendTo(n);var i=parseInt(e.css("height"));e.remove();return i};var updateDomFuncs=[];var applyFunc=function(t){t.$el.css(t.prop,t.value)};var runDomFuncs=function(){updateDomFuncs.map(applyFunc);updateDomFuncs=[];updateWindowWidth()};var updateDomFunc=function(t){if(updateDomFuncs.length===0){setTimeout(runDomFuncs)}updateDomFuncs.push(t)};var el=function(t){return component(function(n){var e=Stream.never();var r=Stream.never();var o=function(){var t=findMinHeight(i.$el);i.minWidth.push(mw);i.minHeight.push(t)};var a=$(document.createElement(t));if(a.prop("tagName").toLowerCase()==="div"){a.css("pointer-events","none")}else{a.css("pointer-events","initial")}a.css("position","absolute");a.css("visibility","hidden");n.$el.append(a);n.top.onValue(function(t){updateDomFunc({$el:a,prop:"top",value:px(t)})});n.left.onValue(function(t){updateDomFunc({$el:a,prop:"left",value:px(t)})});n.width.onValue(function(t){updateDomFunc({$el:a,prop:"width",value:px(t)})});n.height.onValue(function(t){updateDomFunc({$el:a,prop:"height",value:px(t)})});Stream.combine([n.width,n.height,n.top,n.left],function(){updateDomFunc({$el:a,prop:"visibility",value:""})});n.backgroundColor.onValue(function(t){a.css("background-color",colorString(t))});n.fontColor.onValue(function(t){a.css("color",colorString(t))});var u=[];var h=Stream.combine([n.scroll,n.top],function(t,n){return t-n});var l=Stream.combine([n.topAccum,n.top],function(t,n){return t+n});var c=Stream.combine([n.leftAccum,n.left],function(t,n){return t+n});var s=Stream.combine([n.brightness,n.backgroundColor],function(t,n){var e=colorBrightness(n);return n.a*e+(1-n.a)*t});var m=function(t){return{$el:a,scroll:h,topAccum:l,top:Stream.never(),left:Stream.never(),leftAccum:c,width:Stream.never(),height:Stream.never(),backgroundColor:Stream.once(transparent),fontColor:Stream.never(),brightness:s}};return{$el:a,optimalWidth:0,minWidth:e,minHeight:r,newCtx:m,childComponentPs:u,child:function(t){u.push(t)},children:function(t){u.push(t)},destroy:function(){e.end();r.end();var t=this.childInstances||[];for(var n=0;n<t.length;n++){var i=t[n];if($.isArray(i)){var o=i;o.map(function(t){t.destroy()})}else{i.destroy()}}this.$el.remove()},updateDimensions:function(t){var n=findMinWidth(this.$el);var e=findMinHeight(this.$el);if(this.$el.prop("tagName")!=="IMG"){if(!t||n!==0){this.minWidth.push(n)}if(!t||e!==0){this.minHeight.push(e)}}}}})};var a=el("a");var button=el("button");var div=el("div");var form=el("form");var iframe=el("iframe");var img=el("img");var input=el("input");var li=el("li");var option=el("option");var select=el("select");var textarea=el("textarea");var ul=el("ul");var rootContext=function(){return{$el:$("body"),top:Stream.once(0),topAccum:Stream.once(0),left:Stream.once(0),leftAccum:Stream.once(0),scroll:windowScroll,width:windowWidth,height:Stream.never(),backgroundColor:Stream.once(transparent),fontColor:Stream.once(black),brightness:Stream.once(1)}};var rootComponent=function(t,n,e){var i=$.extend(rootContext(),n);var r=t.create(i);r.minHeight.pushAll(i.height);if(e){i.width.map(function(t){i.$el.css("width",t)});i.height.map(function(t){i.$el.css("height",t)})}return r};var add=function(t,n){return t+n};var mathMax=function(t,n){return Math.max(t,n)};var mathMin=function(t,n){return Math.min(t,n)};var passThroughToFirst=function(t,n,e){e.minHeight.pushAll(t.minHeight);e.minWidth.pushAll(t.minWidth);return[{width:n.width,height:n.height,top:Stream.once(0),left:Stream.once(0)}]};var unit=function(t){return function(n){return n+t}};var px=unit("px");var url=function(t){return'url("'+t+'")'};var debugPrintHeight=function(t){t.minHeight.map(function(t){console.log(t);console.log((new Error).stack)})};var debugPrintWidth=function(t){t.minWidth.map(function(t){console.log(t);console.log((new Error).stack)})};var $$=function(t){return function(){var n=Array.prototype.slice.call(arguments);return function(e){e.$el[t].apply(e.$el,n);if(e.$el.hasClass("text")||e.$el.hasClass("paragraph")||e.$el.hasClass("image")||"BUTTON"===e.$el.prop("tagName")||"INPUT"===e.$el.prop("tagName")||"TEXTAREA"===e.$el.prop("tagName")){e.updateDimensions(true);if(!e.$el.hasClass("waiting-for-width")){e.$el.addClass("waiting-for-width");var i=findMinWidth(e.$el);var r=1e3;var o=1.1;var a=function(t){return function(){var n=findMinWidth(e.$el);if(n!==i){e.updateDimensions(true);e.$el.removeClass("waiting-for-width")}else{setTimeout(a(t*o),t)}}};setTimeout(a(r))}}}}};var $addClass=$$("addClass");var $css=$$("css");var $attr=$$("attr");var $prop=$$("prop");var $cssC=liftCF($css);var chooseHeightFromWidth=function(t,n){var e=false;n.width.onValue(function(n){if(!e){e=true;setTimeout(function(){var i=findOptimalHeight(t.$el,n);t.minHeight.push(i);e=false})}})};var $html=function(t,n){return function(e,i){e.$el.html(t);chooseHeightFromWidth(e,i);if(n){e.updateDimensions()}}};var windowWidth=Stream.never();var windowHeight=Stream.never();var updateWindowWidth=function(){windowWidth.push(document.documentElement.clientWidth)};var updateWindowHeight=function(){windowHeight.push(window.innerHeight)};$(updateWindowWidth);$(updateWindowHeight);$(window).on("resize",function(){updateWindowWidth();updateWindowHeight()});var windowResize=Stream.once(null);$(window).on("resize",function(t){windowResize.push(t)});var windowScroll=Stream.never();$(window).on("scroll",function(){windowScroll.push(window.scrollY)});windowScroll.push(window.scrollY);var windowHash=Stream.never();$(window).on("hashchange",function(){windowHash.push(location.hash)});windowHash.push(location.hash);var withMinWidth=function(t,n){return function(e){e.minWidth.push(t);if(n){e.minWidth.end()}}};var withMinHeight=function(t,n){return function(e){e.minHeight.push(t);if(n){e.minHeight.end()}}};var adjustMinSize=function(t){return function(n){return div.all([child(n),wireChildren(function(n,e,i){i.minWidth.map(function(n){return t.mw(n)}).pushAll(n.minWidth);i.minHeight.map(function(n){return t.mh(n)}).pushAll(n.minHeight);return[{top:Stream.once(0),left:Stream.once(0),width:e.width,height:e.height}]})])}};var link=function(t){t.$el.css("cursor","pointer").css("pointer-events","all")};var componentName=function(t){return function(n){n.$el.addClass(t)}};var onThis=function(t){return function(n){return function(e){var i=false;e.$el.on(t,function(t){if(!i){return n(t,function(){i=true;return function(){i=false}},e)}})}}};var changeThis=onThis("change");var clickThis=onThis("click");var inputPropertychangeThis=onThis("input propertychange");var keydownThis=onThis("keydown");var keyupThis=onThis("keyup");var mousedownThis=onThis("mousedown");var mousemoveThis=onThis("mousemove");var mouseoverThis=onThis("mouseover");var mouseoutThis=onThis("mouseout");var mouseupThis=onThis("mouseup");var submitThis=onThis("submit");var hoverThis=function(t){return function(n){t(false,n);n.$el.on("mouseover",function(e){t(true,n,e)});n.$el.on("mouseout",function(e){t(false,n,e)})}};var hoverStream=function(t,n){n=n||function(t){return t};return function(e){e.$el.css("pointer-events","initial");e.$el.on("mouseover",function(e){t.push(n(e));e.stopPropagation()});$("body").on("mouseover",function(e){t.push(n(false))})}};var cssStream=function(t,n){return function(e){n.map(function(n){e.$el.css(t,n)})}};var withBackgroundColor=function(t,n){if(!t.map){t=Stream.once({backgroundColor:t,fontColor:n})}return function(n,e){t.map(function(t){var n=t.backgroundColor;var i=t.fontColor;e.backgroundColor.push(n);setTimeout(function(){setTimeout(function(){var t=n.a*colorBrightness(n)+(1-n.a)*e.brightness.lastValue();e.fontColor.push(i||(t>.5?black:white))})})})}};var withFontColor=function(t){return function(n,e){e.fontColor.push(t)}};var hoverColor=function(t,n,e,i){t=colorString(t||transparent);n=colorString(n||t);e=colorString(e||black);i=colorString(i||e);return hoverThis(function(r,o){o.$el.css("background-color",r?n:t);o.$el.css("color",r?i:e)})};var keepAspectRatioCorner=function(t){t=t||{};return function(n){return div.all([$css("overflow","hidden"),child(n),wireChildren(function(n,e,i){i.minWidth.pushAll(n.minWidth);i.minHeight.pushAll(n.minHeight);var r={top:Stream.create(),left:Stream.create(),width:Stream.create(),height:Stream.create()};Stream.combine([i.minWidth,i.minHeight,e.width,e.height],function(n,e,i,o){var a=n/e;var u=i/o;if(!t.fillSpace&&u>a||t.fillSpace&&u<a){var h=o*a;var l;if(t.left){l=0}else if(t.right){l=i-h}else{l=(i-h)/2}r.top.push(0);r.left.push(l);r.width.push(h);r.height.push(o)}else{var c=i/a;var s;if(t.top){s=0}else if(t.bottom){s=o-c}else{s=(o-c)/2}r.top.push(s);r.left.push(0);r.width.push(i);r.height.push(c)}});return[r]})])}};var keepAspectRatio=keepAspectRatioCorner();var keepAspectRatioFill=keepAspectRatioCorner({fillSpace:true});var image=function(t){var n=t.src&&t.src.map?t.src:Stream.once(t.src);return img.all([componentName("image"),$css("pointer-events","all"),function(e,i){n.map(function(t){e.$el.prop("src",t)});e.$el.css("display","none");e.$el.on("load",function(){e.$el.css("display","");var n=e.$el[0].naturalWidth;var r=e.$el[0].naturalHeight;var o=n/r;var a=t.minWidth||t.chooseWidth||n;var u=t.minHeight||t.chooseHeight||a/o;e.minWidth.push(a);e.minHeight.push(u);var h,l;if(t.minWidth!==undefined&&t.minWidth!==null){h=t.minWidth;l=h/o;e.minWidth.push(h);e.minHeight.push(l)}else if(t.minHeight!==undefined&&t.minHeight!==null){l=t.minHeight;h=l*o;e.minWidth.push(h);e.minHeight.push(l)}else if(t.useNativeWidth){e.minWidth.push(n);e.minHeight.push(r)}else{e.minWidth.push(n)}if(!t.useNativeWidth){i.width.map(function(t){return t/o}).pushAll(e.minHeight)}})}])};var linkTo=function(t,n){return a.all([$prop("href",t),child(n.all([$css("pointer-events","initial")])),wireChildren(passThroughToFirst)])};var nothing=div.all([componentName("nothing"),withMinHeight(0),withMinWidth(0)]);var text=function(t){if(!(t.map&&t.push)){t=Stream.once(t)}return div.all([componentName("text"),$css("pointer-events","all"),$css("white-space","nowrap"),function(n,e){chooseHeightFromWidth(n,e);t.onValue(function(t){if(t){while(t.indexOf(" ")!==-1){t=t.replace(" ","&nbsp;")}}n.$el.html(t);n.minWidth.push(findMinWidth(n.$el))})}])};var faIcon=function(t){return text('<i class="fa fa-'+t+'"></i>')};var paragraph=function(t,n){if(!(t.map&&t.push)){t=Stream.once(t)}n=n||0;return div.all([componentName("paragraph"),$css("pointer-events","all"),function(e,i){chooseHeightFromWidth(e,i);e.updateDimensions=function(){e.minWidth.push(findScrollWidth(e.$el,n))};t.onValue(function(t){e.$el.html(t);e.updateDimensions()});Stream.combine([t,i.width],function(t,n){var i=findOptimalHeight(e.$el,n);e.minHeight.push(i)})}])};var ignoreSurplusWidth=function(t,n){return n};var ignoreSurplusHeight=function(t,n){return n};var centerSurplusWidth=function(t,n){var e=n[n.length-1];var i=t-(e.left+e.width);var r=i/n.length;n.map(function(t,n){t.left+=i/2});return n};var evenSplitSurplusWidth=function(t,n){var e=n[n.length-1];var i=t-(e.left+e.width);var r=i/n.length;n.map(function(t,n){t.width+=r;t.left+=n*r});return n};var justifySurplusWidth=function(t,n){var e=n[n.length-1];var i=t-(e.left+e.width);n.map(function(t,e){for(var r=0;r<e;r++){t.left+=i/(n.length-1)}});return n};var justifyAndCenterSurplusWidth=function(t,n){var e=n[n.length-1];var i=t-(e.left+e.width);n.map(function(t,e){t.left+=e*i/n.length+i/(2*n.length)});return n};var surplusWidthAlign=function(t){return function(n,e){var i=e[e.length-1];var r=n-(i.left+i.width);e.map(function(n,e){n.left+=t*r});return e}};var surplusWidthAlignLeft=surplusWidthAlign(0);var surplusWidthAlignCenter=surplusWidthAlign(.5);var surplusWidthAlignRight=surplusWidthAlign(1);var superSurplusWidth=function(t,n){var e=n[n.length-1];var i=t-(e.left+e.width);if(n.length===1){if(i<n[0].width){return evenSplitSurplusWidth(t,n)}else{return n}}if(n.length===2){return justifyAndCenterSurplusWidth(t,n)}return justifySurplusWidth(t,n)};var giveToNth=function(t){return function(n,e){var i=e[e.length-1];var r=n-(i.left+i.width);e.map(function(n,i){if(i===t||i===e.length-1&&t>=e.length){n.width+=r}else if(i>t){n.left+=r}});return e}};var giveToFirst=giveToNth(0);var giveToSecond=giveToNth(1);var giveToThird=giveToNth(2);var giveHeightToNth=function(t){return function(n,e){var i=e[e.length-1];var r=n-(i.top+i.height);e.map(function(n,i){if(i===t||i===e.length-1&&t>=e.length){n.height+=r}else if(i>t){n.top+=r}});return e}};var giveHeightToLast=function(t,n){var e=n.length-1;var i=n[n.length-1];var r=t-(i.top+i.height);n.map(function(t,i){if(i===e||i===n.length-1&&e>=n.length){t.height+=r}else if(i>e){t.top+=r}});return n};var slideshow=function(t,n){t.gutterSize=t.gutterSize||0;t.leftTransition=t.leftTransition||"none";t.alwaysFullWidth=t.alwaysFullWidth||false;return div.all([$css("overflow","hidden"),componentName("slideshow"),children(n.map(function(n){return n.all([$css("transition","left "+t.leftTransition)])})),wireChildren(function(n,e,i){var r=Stream.combine(i.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t});r.onValue(function(e){n.minWidth.push(e.reduce(add,t.gutterSize*(i.length-1)))});var o=i.map(function(){return{top:Stream.once(0),left:Stream.never(),width:Stream.never(),height:e.height}});Stream.all([t.selectedS,e.width,r],function(n,e,i){var r=0;var a=0;var u=0;var h=i.map(function(i,o){i=t.alwaysFullWidth?e:i;if(n===o){r=u+t.gutterSize*o;a=i}var h={left:u+t.gutterSize*o,width:i};u+=i;return h});var l=(e-a)/2-r;h.map(function(t){t.left+=l});h.map(function(t,n){var e=o[n];e.left.push(t.left);e.width.push(t.width)})});Stream.combine(i.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);var n=t.reduce(mathMax,0);o.map(function(t){t.height.push(n)});return n}).pushAll(n.minHeight);return[o]})])};var slideshowVertical=function(t,n){t.gutterSize=t.gutterSize||0;t.topTransition=t.topTransition||"none";t.alwaysFullHeight=t.alwaysFullHeight||false;return div.all([$css("overflow","hidden"),componentName("slideshow"),children(n.map(function(n){return n.all([$css("transition","top "+t.topTransition)])})),wireChildren(function(n,e,i){var r=Stream.combine(i.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t});r.onValue(function(t){n.minHeight.push(t.reduce(mathMax,0))});var o=i.map(function(t){return{top:Stream.never(),left:Stream.once(0),width:e.width,height:t.minHeight}});Stream.all([t.selected,e.height,r],function(n,e,i){var r=0;var a=0;var u=0;var h=i.map(function(i,o){i=t.alwaysFullHeight?e:i;if(n===o){r=u+t.gutterSize*o;a=i}var h={top:u+t.gutterSize*o,height:i};u+=i;return h});var l=(e-a)/2-r;h.map(function(t){t.top+=l});h.map(function(t,n){var e=o[n];e.top.push(t.top);e.height.push(t.height)})});Stream.combine(i.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);var n=t.reduce(mathMax,0);return n}).pushAll(n.minWidth);return[o]})])};var sideBySide=function(t,n){t.gutterSize=t.gutterSize||0;t.handleSurplusWidth=t.handleSurplusWidth||ignoreSurplusWidth;return div.all([componentName("sideBySide"),children(n),wireChildren(function(n,e,i){var r=Stream.combine(i.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t});r.onValue(function(e){n.minWidth.push(e.reduce(add,t.gutterSize*(i.length-1)))});var o=i.map(function(){return{top:Stream.once(0),left:Stream.never(),width:Stream.never(),height:e.height}});Stream.all([e.width,r],function(n,e){var i=0;var r=e.map(function(n,e){var r={left:i+t.gutterSize*e,width:n};i+=n;return r});r=t.handleSurplusWidth(n,r);r.map(function(t,n){var e=o[n];e.left.push(t.left);e.width.push(t.width)})});Stream.combine(i.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}).pushAll(n.minHeight);return[o]})])};var slider=function(t,n){t=t||{};t.leftTransition=t.leftTransition||"0s";var e=Stream.once(false);var i={left:"left",right:"right"};var r=Stream.once({index:0,edge:"left"});var o=0;return div.all([componentName("slider"),$css("overflow-x","hidden"),$css("cursor","move"),children(n),wireChildren(function(n,i,a){var u=Stream.combine(a.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t});var h=u.map(function(t){return t.reduce(add,0)});u.onValue(function(t){n.minWidth.push(t.reduce(mathMax,0))});Stream.combine(a.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}).pushAll(n.minHeight);var l=Stream.combine([i.width,u,r,e],function(t,n,e,i){var r=e.edge==="left"?0:t;n.map(function(t,n){if(n<e.index){r-=t}if(e.edge==="right"&&n===e.index){r-=t}});if(i!==false){r+=i}return r});var c=Stream.combine([u,l],function(t,n){return t.reduce(function(t,n){t.arr.push(t.lastValue);t.lastValue+=n;return t},{arr:[],lastValue:n}).arr});n.$el.css("user-select","none");n.$el.on("mousedown",function(t){t.preventDefault();e.push(0);a.map(function(t){t.$el.css("transition","left 0s")})});var s=function(n){a.map(function(n){n.$el.css("transition","left "+t.leftTransition)});var o=u.lastValue();var h=i.width.lastValue();var c=e.lastValue();if(!c){return}var s=l.lastValue();var m=o.reduce(function(t,n){var e=t[t.length-1];t.push(e-n);return t},[0]);var f=m.reduce(function(t,n,e){var i=Math.abs(n-s);var r=Math.abs(n-(s-h));return{left:i<t.left.distance?{distance:i,index:e}:t.left,right:r<t.right.distance?{distance:r,index:e-1}:t.right}},{left:{distance:Number.MAX_VALUE,index:-1},right:{distance:Number.MAX_VALUE,index:-1}});if(f.left.distance<=f.right.distance){r.push({index:f.left.index,edge:"left"})}else{r.push({index:f.right.index,edge:"right"})}e.push(false);n.preventDefault()};n.$el.on("mouseup",s);n.$el.on("mouseout",s);n.$el.on("mousemove",function(t){var n=e.lastValue();var r=h.lastValue();var a=i.width.lastValue();var u=l.lastValue();if(n!==false){var c=t.clientX-o;var s=u+c;s=Math.min(0,s);if(r>a){s=Math.max(a-r,s)}c=s-u;n=n+c;e.push(n)}o=t.clientX});return[a.map(function(t,n){return{top:Stream.once(0),left:c.map(function(t){return t[n]}),width:t.minWidth,height:i.height}})]})]).all([])};var stack2=function(t,n){t.gutterSize=t.gutterSize||0;t.handleSurplusHeight=t.handleSurplusHeight||ignoreSurplusHeight;return div.all([componentName("stack2"),children(n),wireChildren(function(n,e,i){var r=Stream.combine(i.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t});r.onValue(function(e){n.minHeight.push(e.reduce(add,t.gutterSize*(i.length-1)))});var o=i.map(function(){return{top:Stream.create(),left:Stream.once(0),width:e.width,height:Stream.never()}});Stream.all([e.height,r],function(n,e){var i=0;var r=e.map(function(n,e){var r={top:i+t.gutterSize*e,height:n};i+=n;return r});r=t.handleSurplusHeight(n,r);r.map(function(t,n){var e=o[n];e.top.push(t.top);e.height.push(t.height)})});Stream.combine(i.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}).pushAll(n.minWidth);return[o]})])};var intersperse=function(t,n){var e=[];t.map(function(t){e.push(t);e.push(n)});e.pop();return e};var stackTwo=function(t,n){t.gutterSize=t.gutterSize||0;t.align=t.align||"left";return div.all([componentName("stack"),children(n),wireChildren(function(n,e,i){var r=i[0];var o=i[1];var a=t.gutterSize;var u=[];n.minHeight.push(0);n.minWidth.push(0);Stream.combine([r.minHeight,o.minHeight],function(t,n){return t+n+a}).pushAll(n.minHeight);Stream.combine([r.minWidth,o.minWidth],function(t,n){return Math.max(t,n)}).pushAll(n.minWidth);return[[{top:Stream.once(0),left:Stream.once(0),width:e.width,height:r.minHeight},{top:r.minHeight.map(function(t){return t+a}),left:Stream.once(0),width:e.width,height:o.minHeight}]]})])};var stack=function(t,n){t.gutterSize=t.gutterSize||0;t.collapseGutters=t.collapseGutters||false;t.align=t.align||"left";if(n.length===0){n=[nothing]}return div.all([componentName("stack"),children(n),wireChildren(function(n,e,i){var r=t&&t.gutterSize||0;var o=function(n){if(n.length===0){return Stream.once(0)}return Stream.combine(n.map(function(n,i){var r;if(t&&t.mhs&&t.mhs[i]){var o=t.mhs[i](e);return Stream.combine([n.minHeight,o],mathMax)}else{return n.minHeight}return n.minHeight}),function(){var n=Array.prototype.slice.call(arguments);var e=n.reduce(function(n,e){return n+e+(t.collapseGutters&&e===0?0:r)},-r);return e})};var a=[];i.reduce(function(n,i,u){var h=o(n).map(function(n){return n+(u===0||t.collapseGutters&&n===0?0:r)});var l;if(t&&t.mhs&&t.mhs[n.length]){var c=t.mhs[n.length](e);l=Stream.combine([i.minHeight,c],mahtMax)}else{l=i.minHeight}a.push({top:h,left:Stream.once(0),width:e.width,height:l});n.push(i);return n},[]);o(i).pushAll(n.minHeight);Stream.combine(i.map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}).pushAll(n.minWidth);return[a]})])};var adjustPosition=function(t,n){var e=t.top||0;var i=t.left||0;var r=t.expand;return div.all([componentName("adjustPosition"),child(n),wireChildren(function(t,n,o){o.minWidth.map(function(t){return t+r?i:0}).pushAll(t.minWidth);o.minHeight.map(function(t){return t+r?e:0}).pushAll(t.minHeight);return[{top:n.top.map(function(t){return t+e}),left:n.left.map(function(t){return t+i}),width:n.width,height:n.height}]})])};var padding=function(t,n){var e=t.all||0,i=t.all||0,r=t.all||0,o=t.all||0;if($.isNumeric(t)){e=i=r=o=t}else{for(var a in t){var u=a.toLowerCase();if(t[a]!==null){if(u.indexOf("top")!==-1){e=t[a]}if(u.indexOf("bottom")!==-1){i=t[a]}if(u.indexOf("left")!==-1){r=t[a]}if(u.indexOf("right")!==-1){o=t[a]}}}}return div.all([componentName("padding"),child(n),wireChildren(function(t,n,a){a.minWidth.map(function(t){return t+r+o}).pushAll(t.minWidth);a.minHeight.map(function(t){return t+e+i}).pushAll(t.minHeight);return[{top:Stream.once(e,"padding top"),left:Stream.once(r,"padding left"),width:n.width.map(function(t){return t-r-o}),height:n.height.map(function(t){return t-e-i})}]})])};var margin=function(t){return function(n){return padding(t,n)}};var expandoStream=function(t,n){var e=Stream.create();var i=Stream.create();var r=Stream.create();var o=Stream.create();t.map(function(t){var n=t.all||0,a=t.all||0,u=t.all||0,h=t.all||0;if($.isNumeric(t)){n=a=u=h=t}else{for(var l in t){var c=l.toLowerCase();if(t[l]!==null){if(c.indexOf("top")!==-1){n=t[l]}if(c.indexOf("bottom")!==-1){a=t[l]}if(c.indexOf("left")!==-1){u=t[l]}if(c.indexOf("right")!==-1){h=t[l]}}}}e.push(n);i.push(a);r.push(u);o.push(h)});return div.all([componentName("padding"),child(n),wireChildren(function(t,n,a){var u=t.newCtx();Stream.combine([a.minWidth,r,o],function(n,e,i){t.minWidth.push(n)});Stream.combine([r,o,n.width],function(t,n,e){u.left.push(t);u.width.push(e-t-n)});Stream.combine([a.minHeight,e,i],function(n,e,i){t.minHeight.push(n)});Stream.combine([e,i,n.height],function(t,n,e){u.top.push(t);u.height.push(e-t-n)});return[u]})])};var alignLRM=function(t){return div.all([componentName("alignLRM"),child(t.middle||nothing),child(t.left||nothing),child(t.right||nothing),wireChildren(function(t,n,e,i,r){var o=Stream.combine([e,i,r].map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);var n=t.reduce(function(t,n){return Math.max(t,n)},0);return n});o.pushAll(t.minHeight);Stream.combine([e,i,r].map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);var n=t.reduce(function(t,n){return t+n},0);return n}).pushAll(t.minWidth);var a=function(t,n){return Stream.combine([t,n],mathMin)};var u=a(n.width,e.minWidth);var h=a(n.width,i.minWidth);var l=a(n.width,r.minWidth);return[{top:Stream.once(0),left:Stream.combine([n.width,u],function(t,n){return(t-n)/2}),width:u,height:n.height},{top:Stream.once(0),left:Stream.once(0),width:h,height:n.height},{top:Stream.once(0),left:Stream.combine([n.width,l],function(t,n){return t-n}),width:l,height:n.height}]})])};var alignTBM=function(t){t.middle=t.middle||nothing;t.bottom=t.bottom||nothing;t.top=t.top||nothing;return div.all([componentName("alignTBM"),child(t.middle),child(t.bottom),child(t.top),wireChildren(function(t,n,e,i,r){var o=Stream.combine([e,i,r].map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);var n=t.reduce(function(t,n){return Math.max(t,n)},0);return n});o.pushAll(t.minWidth);Stream.combine([e,i,r].map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);var n=t.reduce(function(t,n){return t+n},0);return n}).pushAll(t.minHeight);return[{top:Stream.combine([n.height,e.minHeight],function(t,n){return(t-n)/2}),left:Stream.once(0),width:n.width,height:e.minHeight},{top:Stream.combine([n.height,i.minHeight],function(t,n){return t-n}),left:Stream.once(0),width:n.width,height:i.minHeight},{top:Stream.once(0),left:Stream.once(0),width:n.width,height:r.minHeight}]})])};var invertOnHover=function(t){var n=Stream.once(false,"invert");var e=function(t,e){return Stream.combine([n,t,e],function(t,n,e){return t?e:n},"choose stream")};return div.all([componentName("invert-on-hover"),child(t.and($css("transition","background-color 0.2s linear, color 0.1s linear"))),wireChildren(function(t,n,i){i.minHeight.pushAll(t.minHeight);i.minWidth.pushAll(t.minWidth);return[{backgroundColor:e(n.backgroundColor,n.fontColor),fontColor:e(n.fontColor,n.backgroundColor),top:Stream.once(0),left:Stream.once(0),width:n.width,height:n.height}]}),mouseoverThis(function(){n.push(true)}),mouseoutThis(function(){n.push(false)})])};var border=function(t,n,e){var i=n.left||n.all||0;var r=n.right||n.all||0;var o=n.top||n.all||0;var a=n.bottom||n.all||0;var u=n.radius||0;if(!t.onValue){t=Stream.once(t)}var h=t.map(colorString);return div.all([componentName("border"),child(div.all([componentName("border-child"),$css("border-radius",px(u)),child(e),wireChildren(passThroughToFirst)])),function(t){h.map(function(n){t.$el.css("border-left",px(i)+" solid "+n);t.$el.css("border-right",px(r)+" solid "+n);t.$el.css("border-top",px(o)+" solid "+n);t.$el.css("border-bottom",px(a)+" solid "+n)})},wireChildren(function(t,n,e){e.minWidth.map(function(t){return t+i+r}).pushAll(t.minWidth);e.minHeight.map(function(t){return t+o+a}).pushAll(t.minHeight);return[{top:Stream.once(0),left:Stream.once(0),width:n.width.map(function(t){return t-i-r}),height:n.height.map(function(t){return t-o-a})}]})])};var componentStream=function(t){var n;return div.all([componentName("component-stream"),function(e,i){var r=e.newCtx();r.top.push(0);r.left.push(0);i.width.pushAll(r.width);i.height.pushAll(r.height);var o=Stream.create();
t.pushAll(o);o.map(function(t){var i=function(t){if(n){n.destroy()}n=t.create(r);n.$el.css("transition","inherit");n.minWidth.pushAll(e.minWidth);n.minHeight.pushAll(e.minHeight)};if(t.then){t.then(function(t){i(t)},function(t){console.error("child components failed to load");console.log(t)})}else{i(t)}});return function(){o.end();if(n){n.destroy()}}}])};var componentStreamWithExit=function(t,n){var e;return div.all([componentName("component-stream"),function(i,r){var o=i.newCtx();o.top.push(0);o.left.push(0);r.width.pushAll(o.width);r.height.pushAll(o.height);var a=Stream.create();t.pushAll(a);a.map(function(t){var r=function(t){if(e){(function(t){n(t).then(function(){t.destroy()})})(e)}e=t.create(o);e.$el.css("transition","inherit");e.minWidth.pushAll(i.minWidth);e.minHeight.pushAll(i.minHeight)};if(t.then){t.then(function(t){r(t)},function(t){console.error("child components failed to load");console.log(t)})}else{r(t)}});return function(){a.end();if(e){e.destroy()}}}])};var promiseComponent=function(t){var n=Stream.once(nothing);t.then(function(t){n.push(t)},function(t){console.log(t)}).catch(function(t){console.log(t)});return componentStream(n)};var toggleComponent=function(t,n){return componentStream(n.map(function(n){return t[n]}))};var modalDialog=function(t){return function(n,e){var i=Stream.once(false);n.pushAll(i);e=e||0;return div.all([$css("z-index",100),componentName("toggle-height"),child(t),wireChildren(function(t,n,r){t.minWidth.push(0);t.minHeight.push(0);var o=r.$el;o.css("position","fixed");o.css("transition",o.css("transition")+", opacity "+e+"s");o.css("display","none");o.css("pointer-events","initial");i.onValue(function(t){if(t){o.css("display","");setTimeout(function(){o.css("opacity",1)},100)}else{o.css("opacity",0);setTimeout(function(){o.css("display","none")},e*1e3)}});return[{width:windowWidth.map(function(){return window.innerWidth}),height:windowHeight,left:Stream.once(0),top:Stream.once(0)}]})])}};var toggleHeight=function(t){var n=Stream.once(false);t.pushAll(n);return function(t){return div.all([$css("overflow","hidden"),componentName("toggle-height"),child(t),wireChildren(function(t,e,i){i.minWidth.pushAll(t.minWidth);Stream.combine([i.minHeight,n],function(t,n){return n?t:0}).pushAll(t.minHeight);return[{top:Stream.once(0),left:Stream.once(0),width:e.width,height:e.height}]})])}};var dropdownPanel=function(t,n,e,i){i=i||{};i.transition=i.transition||"0.5s";return div.all([componentName("dropdown-panel"),child(div.all([child(n),wireChildren(function(t,n,r){r.minWidth.pushAll(t.minWidth);r.minHeight.pushAll(t.minHeight);r.$el.css("transition","top "+i.transition);t.$el.css("pointer-events","none");r.$el.css("pointer-events","initial");r.$el.css("z-index","1000");return[{width:n.width,height:r.minHeight,top:Stream.combine([e,r.minHeight],function(t,n){return t?0:-n}),left:Stream.once(0)}]}),$css("overflow","hidden")])),child(t),wireChildren(function(t,n,e,r){Stream.combine([e.minWidth,r.minWidth],Math.max).pushAll(t.minWidth);r.minHeight.pushAll(t.minHeight);if(i.panelHeightS){e.minHeight.pushAll(i.panelHeightS)}return[{width:n.width,height:e.minHeight,top:r.minHeight,left:Stream.once(0)},{width:n.width,height:r.minHeight,top:Stream.once(0),left:Stream.once(0)}]})])};var fixedHeaderBody=function(t,n,e){t.transition=t.transition||"0.5s";return div.all([componentName("fixedHeaderBody"),child(e),child(n),wireChildren(function(n,e,i,r){r.$el.css("position","fixed");setTimeout(function(){r.$el.css("transition","height "+t.transition);i.$el.css("transition","top "+t.transition)});Stream.combine([i,r].map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(add,0)}).pushAll(n.minHeight);Stream.combine([i,r].map(function(t){return t.minWidth}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}).pushAll(n.minWidth);return[{top:r.minHeight,left:Stream.once(0),width:e.width,height:i.minHeight},{top:Stream.once(0),left:Stream.once(0),width:e.width,height:r.minHeight}]})])};var makeSticky=function(t){return div.all([componentName("stickyHeaderBody"),child(t),wireChildren(function(t,n,e){e.minWidth.pushAll(t.minWidth);e.minHeight.pushAll(t.minHeight);return[{top:Stream.once(0),left:Stream.combine([e.minHeight,n.scroll,n.top,n.left,n.leftAccum],function(t,n,i,r,o){var a=e.$el;if(i>n){a.css("position","absolute");a.css("transition","");return 0}else if(i<n){var u=r+o;a.css("position","fixed");a.css("left",px(u));setTimeout(function(){a.css("transition","inherit")},20);return u}}),width:n.width,height:n.height}]})])};var stickyHeaderBody=function(t,n,e){return div.all([componentName("stickyHeaderBody"),child(t),child(e),child(n),wireChildren(function(t,n,e,i,r){Stream.combine([e,i,r].map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(add,0)}).pushAll(t.minHeight);var o=false;return[{top:Stream.once(0),left:Stream.once(0),width:n.width,height:e.minHeight},{top:Stream.combine([e.minHeight,r.minHeight],add),left:Stream.once(0),width:n.width,height:i.minHeight},{top:Stream.combine([e.minHeight,n.scroll,n.topAccum],function(t,n,e){var i=r.$el;t=Math.floor(t);if(t>n+e){i.css("position","absolute");i.css("transition","");if(o){window.scrollTo(0,t+e)}o=false;return t}else if(t<n+e){i.css("position","fixed");setTimeout(function(){i.css("transition","inherit")},20);if(!o){window.scrollTo(0,t+e)}o=true;return e}}),left:Stream.once(0),width:n.width,height:r.minHeight}]})])};var grid=function(t,n){t.gutterSize=t.gutterSize||0;t.handleSurplusWidth=t.handleSurplusWidth||ignoreSurplusWidth;t.handleSurplusHeight=t.handleSurplusHeight||ignoreSurplusHeight;t.maxPerRow=t.maxPerRow||0;return padding(t.outerGutter?t.gutterSize:0,div.all([componentName("grid"),children(n),wireChildren(function(n,e,i){if(i.length===0){n.minWidth.push(0);n.minHeight.push(0)}var r=Stream.combine(i.map(function(t){return t.minWidth}),function(){return Array.prototype.slice.call(arguments)});var o=Stream.combine(i.map(function(t){return t.minHeight}),function(){return Array.prototype.slice.call(arguments)});r.map(function(n){return n.reduce(function(n,e){return t.useFullWidth?n+e+t.gutterSize:Math.max(n,e)+t.gutterSize},-t.gutterSize)}).pushAll(n.minWidth);var a=i.map(function(t){return{top:Stream.never(),left:Stream.never(),width:Stream.never(),height:Stream.never()}});var u=Stream.combine([e.width,r],function(n,e){var r=function(){return{cells:[],contexts:[],height:0}};var o=i.reduce(function(i,o,u){var h=i.rows;var l=i.currentRow;var c=e[u];var s=l.cells.reduce(function(n,e){return n+e+t.gutterSize},0);var m=Math.min(c,n);if(t.maxPerRow>0&&l.cells.length===t.maxPerRow||m>0&&m+s>n){h.push(l);l=r()}l.cells.push(m);l.contexts.push(a[u]);return{rows:h,currentRow:l}},{rows:[],currentRow:r()});var u=o.rows;u.push(o.currentRow);u.map(function(e,i){var r=0;var o=e.cells.map(function(n){var e={left:r,width:n};r+=n+t.gutterSize;return e});o=t.handleSurplusWidth(n,o,t,i);o.map(function(t,n){var i=e.contexts[n];i.width.push(t.width)})});return u});var h=Stream.combine([o,u],function(e,i){var r=0;i.map(function(t){t.height=0;t.cells.map(function(n,i){t.height=Math.max(t.height,e[r+i])});r+=t.cells.length});n.minHeight.push(i.map(function(t){return t.height}).reduce(function(n,e){return n+e+t.gutterSize},-t.gutterSize));return i});Stream.all([e.width,e.height,h],function(n,e,i){if(t.bottomToTop){i=i.slice(0).reverse()}var r=0;i=t.handleSurplusHeight(e,i,t);i.map(function(e,i){var o=0;var a=e.cells.map(function(n){var i={top:r,left:o,width:n,height:e.height};o+=n+t.gutterSize;return i});a=t.handleSurplusWidth(n,a,t,i);a.map(function(t,n){var i=e.contexts[n];i.top.push(t.top);i.left.push(t.left);i.width.push(t.width);i.height.push(t.height)});r+=e.height+t.gutterSize})});return[a]})]))};var backgroundImagePosition={fit:"fit",fill:"fill"};var withMinWidthStream=function(t,n){return div.all([componentName("with-min-width-stream"),child(n),wireChildren(function(n,e,i){t(i,e).pushAll(n.minWidth);i.minHeight.pushAll(n.minHeight);return[{top:Stream.once(0),left:Stream.once(0),width:e.width,height:e.height}]})])};var withMinHeightStream=function(t,n){return div.all([componentName("with-min-height-stream"),child(n),wireChildren(function(n,e,i){t(i,e).pushAll(n.minHeight);i.minWidth.pushAll(n.minWidth);return[{top:Stream.once(0),left:Stream.once(0),width:e.width,height:e.height}]})])};var extendToWindowBottom=function(t,n){n=n||Stream.once(0);return withMinHeightStream(function(t,e){return Stream.combine([t.minHeight,e.top,e.topAccum,n,windowResize],function(t,n,e,i){return Math.max(t,window.innerHeight-n-e-i)})},t)};var atMostWindowBottom=function(t,n){n=n||Stream.once(0);return withMinHeightStream(function(t,e){return Stream.combine([t.minHeight,e.top,e.topAccum,n,windowResize],function(t,n,e,i){return Math.min(t,window.innerHeight-n-e-i)})},t)};var overlays=function(t){return div.all([children(t),wireChildren(function(t,n,e){var i=function(t){return Stream.combine(t,function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)})};i(e.map(function(t){return t.minHeight})).pushAll(t.minHeight);i(e.map(function(t){return t.minWidth})).pushAll(t.minWidth);return[e.map(function(t){return{top:Stream.once(0),left:Stream.once(0),width:n.width,height:n.height}})]})])};var withBackground=function(t,n){return div.all([componentName("with-background"),child(t),child(n),wireChildren(function(t,n,e,i){i.minWidth.pushAll(t.minWidth);i.minHeight.pushAll(t.minHeight);var r={top:Stream.once(0),left:Stream.once(0),width:n.width,height:n.height};return[r,r]})])};var withBackgroundImage=function(t,n){var e=Stream.once(t.aspectRatio||1);if(!t.src.map){t.src=Stream.once(t.src)}return div.all([componentName("with-background-image"),$css("overflow","hidden"),child(img.all([$css("visibility","hidden"),function(n,i){n.minWidth.push(0);n.minHeight.push(0);t.src.map(function(t){n.$el.prop("src",t)});n.$el.on("load",function(){var t=findMinWidth(n.$el);var i=findMinHeight(n.$el);var r=t/i;e.push(r)});Stream.all([i.width,i.height],function(){n.$el.css("visibility","")})}])),child(n),wireChildren(function(t,n,i,r){r.minWidth.pushAll(t.minWidth);r.minHeight.pushAll(t.minHeight);var o=t.newCtx();n.top.push(0);n.left.push(0);n.width.pushAll(o.width);n.height.pushAll(o.height);var a=t.newCtx();a.top.push(0);a.left.push(0);Stream.all([e,n.width,n.height],function(t,n,e){var i=n/e;if(t<i){a.width.push(n);a.height.push(n/t)}else{a.width.push(e*t);a.height.push(e)}});return[a,o]})])};var table=function(t,n){t=t||{};var e=(t.paddingSize||0)*2;return div.all(n.map(function(t){return children(t)})).all([componentName("table"),wireChildren(function(){var t=Array.prototype.slice.call(arguments);var n=t[0];var i=t[1];var r=t.slice(2);var o=Stream.combine(r.reduce(function(t,n){t.push(Stream.combine(n.map(function(t){return t.minWidth}),function(){return Array.prototype.slice.call(arguments)}));return t},[]),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(function(t,n){return n.map(function(n,e){return Math.max(t[e]||0,n)})},[])});o.map(function(t){var i=t.reduce(function(t,n){return t+n+e},-e);n.minWidth.push(i)});var a=r.reduce(function(t,n){t.push(Stream.combine(n.map(function(t){return t.minHeight}),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(mathMax,0)}));return t},[]);Stream.combine(a,function(){var t=Array.prototype.slice.call(arguments);var i=t.reduce(function(t,n){return t+n+e},-e);n.minHeight.push(i)});return a.map(function(t,n){return r[n].map(function(t,i){return{width:o.map(function(t){return t[i]}),height:a[n],top:Stream.combine(a.slice(0,n).concat([Stream.once(0)]),function(){var t=Array.prototype.slice.call(arguments);return t.reduce(function(t,n){return t+n+e},-e)}),left:o.map(function(t){return t.reduce(function(t,n,r){return t+(r<i?n+e:0)},0)})}})})})])};var tabs=function(t,n){var e=n||Stream.once(0);return stack({},[sideBySide({handleSurplusWidth:centerSurplusWidth},t.map(function(t,n){return alignTBM({bottom:toggleComponent([t.tab.left,t.tab.right,t.tab.selected],e.map(function(t){if(n<t){return 0}if(n>t){return 1}return 2})).all([link,clickThis(function(){e.push(n)})])})})),componentStream(e.map(function(n){return t[n].content}))])};var matchStrings=function(t){return function(n){for(var e=0;e<t.length;e++){var i=t[e];if(n.indexOf(i.string)===0){return i.router(n.substring(i.string.length))}}}};var routeToComponent=function(t){return function(){return t}};var routeToComponentF=function(t){return function(){return t()}};var routeToFirst=function(t){return function(n){for(var e=0;e<t.length;e++){var i=t[e](n);if(i){return i}}}};var routeMatchRest=function(t){return function(n){return Q(n).then(t)}};var ignoreHashChange=false;var route=function(t){var n;return div.all([child(div.all([componentName("route"),function(e,i){windowHash.onValue(function(r){if(ignoreHashChange){ignoreHashChange=false;return}if(n){n.destroy()}Q.all([t(r)]).then(function(t){var r=t[0];n=r.create(i);n.$el.css("transition","inherit");n.minWidth.pushAll(e.minWidth);n.minHeight.pushAll(e.minHeight)},function(t){console.error("child components failed to load");console.log(t)})})}])),wireChildren(passThroughToFirst)])};